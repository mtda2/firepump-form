<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ระบบตรวจสอบเครื่องยนต์สูบน้ำดับเพลิง</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * { font-family: 'Sarabun', sans-serif; scroll-behavior: smooth; box-sizing: border-box; text-rendering: optimizeLegibility; }
        
        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            color: #333;
            min-height: 100vh;
            overflow: hidden;
            position: relative;
        }

        .aurora-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
        }

        .aurora-shape {
            position: absolute;
            border-radius: 50%;
            filter: blur(120px);
            opacity: 0.5;
        }

        .aurora-shape1 {
            width: 500px;
            height: 500px;
            background: #007aff;
            top: -150px;
            left: -150px;
            animation: move-aurora1 25s infinite alternate ease-in-out;
        }

        .aurora-shape2 {
            width: 450px;
            height: 450px;
            background: #5856d6;
            bottom: -100px;
            right: -100px;
            animation: move-aurora2 28s infinite alternate ease-in-out;
        }

        .aurora-shape3 {
            width: 350px;
            height: 350px;
            background: #34c759;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            animation: move-aurora3 30s infinite alternate ease-in-out;
        }

        @keyframes move-aurora1 {
            from { transform: translate(0, 0) rotate(0deg); }
            to { transform: translate(200px, 100px) rotate(30deg); }
        }
        @keyframes move-aurora2 {
            from { transform: translate(0, 0) rotate(0deg); }
            to { transform: translate(-150px, -50px) rotate(-45deg); }
        }
        @keyframes move-aurora3 {
            from { transform: scale(1) rotate(0deg); }
            to { transform: scale(1.2) rotate(60deg); }
        }

        body.loggedin {
            background: linear-gradient(135deg, #E0F7FA, #CCEEFF, #EBF5FF);
            background-size: 200% 200%;
            animation: gradientBG 15s ease infinite;
            background-attachment: fixed;
            overflow: auto;
        }
        
        @keyframes gradientBG {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        #loginDialog {
            border: 1px solid rgba(255, 255, 255, 0.2);
            background: rgba(255, 255, 255, 0.6);
            backdrop-filter: blur(25px);
            -webkit-backdrop-filter: blur(25px);
            border-radius: 2.5rem;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.2);
            padding: 0;
            max-width: 480px;
            overflow: hidden;
            animation: fadeInUp 0.7s ease-out forwards;
        }
        
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        #loginDialog::backdrop { background: rgba(0, 0, 0, 0.2); }
        #loginDialog .dialog-header { padding: 2.5rem 3rem 2rem 3rem; text-align: center; color: #1f2937; position: relative; }
        #loginDialog .dialog-header .icon-wrapper { width: 80px; height: 80px; margin: 0 auto 1.5rem auto; border-radius: 50%; background: linear-gradient(135deg, #007aff, #5856d6); display: flex; align-items: center; justify-content: center; box-shadow: 0 10px 20px rgba(0, 122, 255, 0.25); }
        #loginDialog .dialog-header h2 { font-size: 2.25rem; font-weight: 700; margin-bottom: 0.5rem; }
        #loginDialog .dialog-header p { color: #4a5568; font-size: 1.1rem; }
        #loginDialog .dialog-body { padding: 0 3rem 3rem 3rem; }
        .input-group { position: relative; margin-bottom: 1.5rem; }
        .input-icon { position: absolute; left: 1.25rem; top: 50%; transform: translateY(-50%); color: #9ca3af; pointer-events: none; }
        #loginDialog .form-input { border-radius: 1rem; border: 1px solid rgba(220, 220, 220, 0.8); padding: 1rem 1.25rem 1rem 3.5rem; font-size: 1rem; background-color: rgba(255, 255, 255, 0.8); transition: all 0.2s ease; width: 100%; }
        #loginDialog .form-input:focus { border-color: #007AFF; box-shadow: 0 0 0 4px rgba(0, 122, 255, 0.25); outline: none; background-color: white; }
        #loginDialog .login-button { background: linear-gradient(45deg, #007AFF, #5856D6); font-size: 1.15rem; padding: 1rem 1.5rem; border-radius: 1rem; font-weight: 600; box-shadow: 0 10px 25px rgba(0, 122, 255, 0.3); transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275); color: white; border: none; width: 100%; display: flex; align-items: center; justify-content: center; gap: 0.5rem; }
        #loginDialog .login-button:hover { transform: translateY(-5px) scale(1.02); box-shadow: 0 15px 30px rgba(0, 122, 255, 0.4); }
        #loginError { font-size: 1rem; margin-top: 1.5rem; height: 1.5rem; }

        .container { max-width: 1200px; }
        .header-container { background: rgba(255, 255, 255, 0.7); backdrop-filter: blur(15px); -webkit-backdrop-filter: blur(15px); border-bottom: 1px solid rgba(255, 255, 255, 0.5); box-shadow: 0 4px 30px rgba(0, 0, 0, 0.08); margin-bottom: 2rem; }
        .header-gradient-text { background: linear-gradient(90deg, #007AFF, #5856D6); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .section-card { background: rgba(255, 255, 255, 0.75); backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px); border: 1px solid rgba(255, 255, 255, 0.6); border-radius: 24px; box-shadow: 0 10px 40px 0 rgba(0, 0, 0, 0.08); transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
        .section-card:hover { transform: translateY(-8px); box-shadow: 0 15px 50px 0 rgba(0, 0, 0, 0.12); }
        .form-label { color: #4a5568; font-weight: 600; }
        .form-input, .form-select, .form-textarea { background: rgba(255, 255, 255, 0.9); border: 1px solid rgba(220, 220, 220, 0.8); border-radius: 14px; padding: 0.85rem 1.15rem; color: #333; transition: all 0.3s ease; box-shadow: inset 0 2px 6px rgba(0,0,0,0.04); }
        .form-input::placeholder, .form-textarea::placeholder { color: #a0aec0; opacity: 0.9; }
        .form-input:focus, .form-select:focus, .form-textarea:focus { border-color: #007AFF; box-shadow: 0 0 0 4px rgba(0, 122, 255, 0.25); background: rgba(255, 255, 255, 1); }
        .radio-group .radio-item, .checkbox-group .checkbox-item { background: rgba(255, 255, 255, 0.8); border: 1px solid rgba(230, 230, 230, 0.7); border-radius: 16px; padding: 0.9rem 1.2rem; cursor: pointer; transition: all 0.3s ease; box-shadow: 0 3px 12px rgba(0,0,0,0.06); display: flex; align-items: center; gap: 0.75rem; }
        .radio-group .radio-item:hover, .checkbox-group .checkbox-item:hover { background: rgba(255, 255, 255, 0.95); box-shadow: 0 6px 16px rgba(0,0,0,0.09); }
        .radio-item:has(input[type="radio"]:checked), .checkbox-item:has(input[type="checkbox"]:checked) { background: linear-gradient(45deg, #D4EBFF, #E0F4FF); border-color: #007AFF; box-shadow: 0 4px 15px rgba(0, 122, 255, 0.2); color: #004080; }
        .radio-item:has(input[type="radio"]:checked) label, .checkbox-item:has(input[type="checkbox"]:checked) label { font-weight: 600; }
        input[type="radio"], input[type="checkbox"] { -webkit-appearance: none; -moz-appearance: none; appearance: none; width: 1.35rem; height: 1.35rem; border: 2px solid #C7C7CC; border-radius: 50%; outline: none; cursor: pointer; display: inline-flex; align-items: center; justify-content: center; transition: all 0.2s ease; background-color: white; flex-shrink: 0; position: relative; }
        input[type="checkbox"] { border-radius: 8px; }
        input[type="radio"]:checked { background-color: #007AFF; border-color: #007AFF; }
        input[type="radio"]:checked::after { content: ''; width: 0.55rem; height: 0.55rem; background-color: white; border-radius: 50%; }
        input[type="checkbox"]:checked { background-color: #007AFF; border-color: #007AFF; }
        input[type="checkbox"]:checked::after { content: '✓'; font-size: 0.9rem; color: white; font-weight: bold; line-height: 1; text-shadow: 0 0 2px rgba(0,0,0,0.2); }
        .btn { border-radius: 16px; padding: 0.9rem 1.6rem; font-weight: 600; transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275); box-shadow: 0 6px 20px rgba(0,0,0,0.1); }
        .btn:hover { transform: translateY(-5px) scale(1.03); box-shadow: 0 10px 25px rgba(0,0,0,0.15); }
        .btn:active { transform: translateY(-2px) scale(0.98); box-shadow: 0 3px 10px rgba(0,0,0,0.1); }
        .theme-gradient-bg { background: linear-gradient(45deg, #007AFF, #5856D6); color: white; }
        .theme-gradient-bg:hover { background: linear-gradient(45deg, #3A8DFF, #6E6EDB); }
        .btn-gray { background: rgba(229, 231, 235, 0.7); color: #333; border: 1px solid rgba(220,220,220,0.8); }
        .btn-gray:hover { background: rgba(229, 231, 235, 0.9); }
        .btn-green { background: linear-gradient(45deg, #34C759, #30D158); color: white; }
        .btn-green:hover { background: linear-gradient(45deg, #4CDA64, #52E070); }
        .btn-red { background: linear-gradient(45deg, #FF3B30, #FF453A); color: white; }
        .btn-red:hover { background: linear-gradient(45deg, #FF5C52, #FF6A60); }
        .btn-orange { background: linear-gradient(45deg, #FF9500, #FF9F0A); color: white; }
        .btn-orange:hover { background: linear-gradient(45deg, #FFAB2D, #FFB540); }
        dialog::backdrop { background: rgba(0, 0, 0, 0.35); backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px); }
        .spinner { border: 3px solid #f3f4f6; border-top: 3px solid #007AFF; border-radius: 50%; width: 20px; height: 20px; animation: spin 1s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        .helper-text { font-size: 0.875rem; color: #6b7280; margin-top: 4px; }
        .section-card { opacity: 0; transform: translateY(30px); transition: opacity 0.7s ease-out, transform 0.7s ease-out; }
        .section-card.is-visible { opacity: 1; transform: translateY(0); }
        .ai-response-card { background: rgba(255, 255, 255, 0.85); backdrop-filter: blur(12px); border: 1px solid rgba(255, 255, 255, 0.5); border-radius: 18px; padding: 1.8rem; margin-bottom: 1.2rem; box-shadow: 0 8px 25px rgba(0, 0, 0, 0.09); border-left-width: 10px; transition: all 0.3s ease; }
        .ai-response-card:hover { transform: translateY(-3px); box-shadow: 0 10px 30px rgba(0,0,0,0.12); }
        .ai-summary { border-left-color: #007AFF; }
        .ai-critical { border-left-color: #FF3B30; }
        .ai-warning { border-left-color: #FF9500; }
        .ai-recommendation { border-left-color: #34C759; }
        .ai-response-card h3 { font-size: 1.35rem; font-weight: 700; margin-bottom: 1.2rem; color: #1f2937; display: flex; align-items: center; gap: 0.85rem; }
        .ai-response-card ul { list-style-type: none; padding-left: 0; }
        .ai-response-card li { margin-bottom: 1.4rem; padding-left: 2rem; position: relative; color: #333; line-height: 1.7; }
        .ai-response-card li::before { content: '🚨'; position: absolute; left: 0; top: 0px; font-size: 1.25rem; line-height: 1; }
        .ai-response-card.ai-warning li::before { content: '⚠️'; }
        .ai-response-card.ai-summary li::before { content: '✨'; }
        .ai-response-card.ai-recommendation li::before { content: '💡'; }
        .ai-response-card .engineering-note { font-size: 0.95rem; color: #4b5563; background-color: rgba(0,0,0,0.06); padding: 0.7rem 1.2rem; border-radius: 10px; margin-top: 1rem; display: block; border-left: 4px solid #9ca3af; line-height: 1.5; }
        .ai-avatar { width: 75px; height: 75px; border-radius: 50%; object-fit: cover; border: 4px solid white; box-shadow: 0 5px 15px rgba(0,0,0,0.2); flex-shrink: 0; }
        #aiDialog .dialog-header-ai { display: flex; align-items: center; border-bottom: 1px solid rgba(229, 231, 235, 0.6); padding-bottom: 18px; margin-bottom: 25px; }
        #aiDialog .dialog-header-content { display: flex; align-items: center; flex-grow: 1; }
        #aiDialog .dialog-header-ai h2 { margin: 0; font-size: 2rem; margin-left: 1.35rem; background: linear-gradient(90deg, #007AFF, #5856D6); -webkit-background-clip: text; -webkit-text-fill-color: transparent; font-weight: 700; }
        #aiDialog { border: none; background: rgba(255, 255, 255, 0.85); backdrop-filter: blur(25px); -webkit-backdrop-filter: blur(25px); border-radius: 2.5rem; box-shadow: 0 20px 50px rgba(0, 0, 0, 0.3); padding: 0; max-width: 90vw; width: 750px; overflow: hidden; transition: all 0.3s ease; }
        #aiDialog .p-6 { padding: 3rem; }
        .fab-container { position: fixed; bottom: 30px; right: 30px; z-index: 50; display: flex; flex-direction: column-reverse; align-items: flex-end; gap: 14px; }
        #fab-toggle { width: 68px; height: 68px; border-radius: 50%; background: linear-gradient(45deg, #007AFF, #5856D6); color: white; box-shadow: 0 10px 30px rgba(0,0,0,0.25); display: flex; align-items: center; justify-content: center; transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275); cursor: pointer; flex-shrink: 0; border: none; }
        #fab-toggle:hover { transform: scale(1.06); box-shadow: 0 15px 35px rgba(0,0,0,0.3); }
        #fab-toggle.toggled { background: linear-gradient(45deg, #FF3B30, #FF453A); }
        #fab-toggle.toggled #fab-toggle-icon { transform: rotate(90deg); }
        #fab-toggle-icon { transition: transform 0.3s ease-in-out; }
        #fab-menu { display: flex; flex-direction: column-reverse; align-items: flex-end; gap: 14px; }
        .fab-menu-item { display: flex; align-items: center; justify-content: flex-end; gap: 0.85rem; opacity: 0; transform: translateY(20px) scale(0.9); transition: opacity 0.05s ease-out, transform 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
        #fab-toggle.toggled + #fab-menu .fab-menu-item { opacity: 1; transform: translateY(0) scale(1); }
        #fab-toggle.toggled + #fab-menu .fab-menu-item:nth-child(1) { transition-delay: 0.25s; }
        #fab-toggle.toggled + #fab-menu .fab-menu-item:nth-child(2) { transition-delay: 0.20s; }
        #fab-toggle.toggled + #fab-menu .fab-menu-item:nth-child(3) { transition-delay: 0.15s; }
        #fab-toggle.toggled + #fab-menu .fab-menu-item:nth-child(4) { transition-delay: 0.10s; }
        #fab-toggle.toggled + #fab-menu .fab-menu-item:nth-child(5) { transition-delay: 0.05s; }
        .fab-menu-item .btn { width: 52px; height: 52px; border-radius: 50%; padding: 0; display: flex; align-items: center; justify-content: center; font-size: 1.3rem; box-shadow: 0 5px 18px rgba(0,0,0,0.12); background: rgba(255,255,255,0.9); color: #333; border: 1px solid rgba(220,220,220,0.8); backdrop-filter: blur(8px); }
        .fab-menu-item .btn:hover { transform: scale(1.1); box-shadow: 0 8px 22px rgba(0,0,0,0.18); }
        .fab-menu-item span { background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(8px); padding: 0.5rem 1rem; border-radius: 12px; font-size: 0.95rem; font-weight: 500; color: #333; box-shadow: 0 3px 12px rgba(0,0,0,0.1); white-space: nowrap; border: 1px solid rgba(220,220,220,0.8); }
        #fab-menu .fab-menu-item .btn-ai { background: linear-gradient(45deg, #007AFF, #5856D6); color: white; }
        #fab-menu .fab-menu-item .btn-preview { background: rgba(229, 231, 235, 0.9); color: #333; }
        #fab-menu .fab-menu-item .btn-submit { background: linear-gradient(45deg, #34C759, #30D158); color: white; }
        #fab-menu .fab-menu-item .btn-reset { background: linear-gradient(45deg, #FF3B30, #FF453A); color: white; }
        #fab-menu .fab-menu-item .btn-export { background: linear-gradient(45deg, #FF9500, #FF9F0A); color: white; }
        .checkbox-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 1rem; }
        .radio-item-other { flex-direction: column; align-items: flex-start !important; }
        
        @media (max-width: 640px) {
            #aiDialog { width: 90vw; max-width: 90vw; }
            #aiDialog .p-6 { padding: 1.5rem; }
            #aiDialog .dialog-header-ai h2 { font-size: 1.5rem; margin-left: 1rem; }
            .ai-avatar { width: 60px; height: 60px; }
            .ai-response-card { padding: 1.25rem; }
            .ai-response-card h3 { font-size: 1.15rem; }
        }
    </style>
</head>
<body>

    <div class="aurora-bg">
        <div class="aurora-shape aurora-shape1"></div>
        <div class="aurora-shape aurora-shape2"></div>
        <div class="aurora-shape aurora-shape3"></div>
    </div>

    <dialog id="loginDialog">
        <div class="dialog-header">
            <div class="icon-wrapper">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4" />
                </svg>
            </div>
            <h2>เข้าสู่ระบบ</h2>
            <p>ระบบตรวจสอบเครื่องยนต์ดับเพลิง</p>
        </div>
        <div class="dialog-body">
            <form id="loginForm">
                <div class="input-group">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 input-icon" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5">
                      <path stroke-linecap="round" stroke-linejoin="round" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                    </svg>
                    <input type="text" id="username" name="username" class="form-input" placeholder="Username" required>
                </div>
                <div class="input-group">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 input-icon" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5">
                      <path stroke-linecap="round" stroke-linejoin="round" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" />
                    </svg>
                    <input type="password" id="password" name="password" class="form-input" placeholder="Password" required>
                </div>
                <button type="submit" id="loginButton" class="login-button">
                    <span>เข้าสู่ระบบ</span>
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                      <path fill-rule="evenodd" d="M10.293 3.293a1 1 0 011.414 0l6 6a1 1 0 010 1.414l-6 6a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-4.293-4.293a1 1 0 010-1.414z" clip-rule="evenodd" />
                    </svg>
                </button>
                <p id="loginError" class="text-red-600 text-center font-semibold"></p>
            </form>
        </div>
    </dialog>
    
    <div id="mainContent" class="hidden">
        <div class="header-container py-6 sm:py-10">
            <div class="container mx-auto px-4 text-center">
                 <div class="flex justify-center items-center gap-4 mb-2">
                    <svg class="w-12 h-12 sm:w-14 sm:h-14 header-gradient-text" viewBox="0 0 64 64" fill="none" xmlns="http://www.w3.org/2000/svg" stroke-width="2.5" stroke="currentColor">
                        <path d="M4 56 H60 V52 H4 Z" fill="currentColor" stroke-linejoin="round"></path>
                        <path d="M26 24 V52 H58 V24 H26 Z M 32 30 V48 M 40 30 V48 M 48 30 V48" fill="none" stroke-linejoin="round" stroke-linecap="round"></path>
                        <path d="M18 48 C 8 48, 4 38, 10 30 S 26 22, 26 34 V 48 Z" fill="none" stroke-linejoin="round" stroke-linecap="round"></path>
                        <circle cx="16" cy="40" r="6" fill="none"></circle>
                        <circle cx="16" cy="40" r="2.5" fill="currentColor"></circle>
                        <path d="M18 26 V 18 H 40" fill="none" stroke-linecap="round"></path>
                        <circle cx="44" cy="18" r="4" fill="none"></circle>
                        <path d="M44 18 L 46 16" fill="none" stroke-linecap="round"></path>
                    </svg>
                    <h1 class="text-3xl sm:text-4xl font-bold header-gradient-text">แบบฟอร์มทดสอบเครื่องยนต์สูบน้ำดับเพลิง</h1>
                 </div>
                 <p class="text-lg sm:text-xl font-semibold text-gray-600">แผนกช่างซ่อมบำรุง โรงพยาบาลเอกชล 2</p>
            </div>
        </div>

        <div class="container mx-auto px-4">
            
            <form id="inspectionForm" onsubmit="submitData(event)">
                
                <div class="section-card p-4 sm:p-7 mb-8">
                    <div class="section-header border-b-2 border-gray-100 pb-4 mb-6"><h2 class="section-title text-lg sm:text-xl font-bold text-gray-800">📋 ข้อมูลพื้นฐาน</h2></div>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-7">
                        <div class="form-group"><label class="form-label block mb-2">วว/ดด/ป</label><input type="date" name="entry.1632403651" class="form-input w-full" required></div>
                        <div class="form-group">
                            <label class="form-label block mb-2">ผู้ปฏิบัติงาน</label>
                            <select id="operatorSelect" name="entry.1231391232" class="form-select w-full" onchange="handleOperatorChange(this)">
                                <option value="" disabled selected>-- กรุณาเลือกรายชื่อ --</option>
                                <option value="ดอน ถาวรวัฒนเจริญ">ดอน ถาวรวัฒนเจริญ</option>
                                <option value="โชคชัย แดงเจริญสุข">โชคชัย แดงเจริญสุข</option>
                                <option value="ณิชาภัทร ภาระพงศ์">ณิชาภัทร ภาระพงศ์</option>
                                <option value="ประเสริฐ ไกรกาจ">ประเสริฐ ไกรกาจ</option>
                                <option value="เกริกฤทธิ์ คำราพิซ">เกริกฤทธิ์ คำราพิซ</option>
                                <option value="กิตติพงษ์ สุวรรณพงษ์">กิตติพงษ์ สุวรรณพงษ์</option>
                                <option value="สหรัฐ อิศรางกูร ณ อยุธยา">สหรัฐ อิศรางกูร ณ อยุธยา</option>
                                <option value="นภัสกร อรุณโรจน์">นภัสกร อรุณโรจน์</option>
                                <option value="ชนะชล ดีทน">ชนะชล ดีทน</option>
                                <option value="อัครพล สะโรบล ณ อยุธยา">อัครพล สะโรบล ณ อยุธยา</option>
                                <option value="ภานุพงศ์ ธำรงธิติธรรม">ภานุพงศ์ ธำรงธิติธรรม</option>
                                <option value="อรุณ แก้วสุริยา">อรุณ แก้วสุริยา</option>
                                <option value="วรวุฒิ บุลาลม">วรวุฒิ บุลาลม</option>
                                <option value="สุกฤต อิงศรางกูร ณ อยุธยา">สุกฤต อิงศรางกูร ณ อยุธยา</option>
                                <option value="ทศพร ภูชมศรี">ทศพร ภูชมศรี</option>
                                <option value="__other_option__">อื่นๆ…</option>
                            </select>
                            <input type="text" id="operatorOther" name="entry.1231391232.other_option_response" class="other-input form-input w-full mt-3 hidden" placeholder="ระบุชื่อผู้ปฏิบัติงาน...">
                        </div>
                    </div>
                    <div class="form-group mt-7"><label class="form-label block mb-2">PLAN(ความถี่ในการตรวจเช็ค)</label><p class="helper-text">M=เดือนละครั้ง, Y=ปีละครั้ง</p><div class="radio-group flex flex-wrap gap-5 mt-2"><div class="radio-item" onclick="selectRadio(this)"><input type="radio" id="plan1" name="entry.994147210" value="M"><label for="plan1">M</label></div><div class="radio-item" onclick="selectRadio(this)"><input type="radio" id="plan2" name="entry.994147210" value="Y"><label for="plan2">Y</label></div></div></div>
                </div>

                <div class="section-card p-4 sm:p-7 mb-8">
                    <div class="section-header border-b-2 border-gray-100 pb-4 mb-6"><h2 class="section-title text-lg sm:text-xl font-bold text-gray-800">🛢️ ระดับของเหลว</h2></div>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-7">
                        <div class="form-group"><label class="form-label block mb-2">Lubricating Oil Level / ระดับน้ำมันหล่อลื่น</label><div class="radio-group flex flex-wrap gap-4"><div class="radio-item" onclick="selectRadio(this)"><input type="radio" name="entry.1618028324" value="สูง"><label>สูง</label></div><div class="radio-item" onclick="selectRadio(this)"><input type="radio" name="entry.1618028324" value="กลาง"><label>กลาง</label></div><div class="radio-item" onclick="selectRadio(this)"><input type="radio" name="entry.1618028324" value="ต่ำ"><label>ต่ำ</label></div></div></div>
                        <div class="form-group"><label class="form-label block mb-2">Cooling Water Level / ระดับน้ำระบายความร้อน</label><div class="radio-group flex flex-wrap gap-4"><div class="radio-item" onclick="selectRadio(this)"><input type="radio" name="entry.14334317" value="สูง"><label>สูง</label></div><div class="radio-item" onclick="selectRadio(this)"><input type="radio" name="entry.14334317" value="กลาง"><label>กลาง</label></div><div class="radio-item" onclick="selectRadio(this)"><input type="radio" name="entry.14334317" value="ต่ำ"><label>ต่ำ</label></div><div class="radio-item radio-item-other" onclick="selectRadio(this)" data-other-target="waterOther"><div class="flex items-center gap-2 w-full"><input type="radio" name="entry.14334317" value="__other_option__"><label>อื่นๆ…</label></div><input type="text" id="waterOther" name="entry.14334317.other_option_response" class="other-input form-input w-full mt-2 hidden" placeholder="ระบุ..."></div></div></div>
                        <div class="form-group"><label class="form-label block mb-2">Battery Distilled Water Level / ระดับน้ำกลั่นของแบตเตอรี่</label><div class="radio-group flex flex-wrap gap-4"><div class="radio-item" onclick="selectRadio(this)"><input type="radio" name="entry.1091386807" value="สูง"><label>สูง</label></div><div class="radio-item" onclick="selectRadio(this)"><input type="radio" name="entry.1091386807" value="กลาง"><label>กลาง</label></div><div class="radio-item" onclick="selectRadio(this)"><input type="radio" name="entry.1091386807" value="ต่ำ"><label>ต่ำ</label></div><div class="radio-item radio-item-other" onclick="selectRadio(this)" data-other-target="batteryOther"><div class="flex items-center gap-2 w-full"><input type="radio" name="entry.1091386807" value="__other_option__"><label>อื่นๆ…</label></div><input type="text" id="batteryOther" name="entry.1091386807.other_option_response" class="other-input form-input w-full mt-2 hidden" placeholder="ระบุ..."></div></div></div>
                    </div>
                    <div class="form-group mt-7"><label class="form-label block mb-2">Fuel Tank Level / ระดับเชื้อเพลิงในถัง(ลิตร)</label><input type="number" name="entry.964120987" class="form-input w-full" min="0" placeholder="กรอกปริมาณเชื้อเพลิง"></div>
                </div>

                <div class="section-card p-4 sm:p-7 mb-8">
                    <div class="section-header border-b-2 border-gray-100 pb-4 mb-6"><h2 class="section-title text-lg sm:text-xl font-bold text-gray-800">💧 การตรวจสอบการรั่วไหล</h2></div>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-7">
                        <div class="form-group"><label class="form-label block mb-2">Fuel Oil Leaks / การรั่วไหลของน้ำมันเชื้อเพลิง</label><div class="radio-group flex flex-wrap gap-4"><div class="radio-item" onclick="selectRadio(this)"><input type="radio" name="entry.323305993" value="ปกติ"><label>ปกติ</label></div><div class="radio-item" onclick="selectRadio(this)"><input type="radio" name="entry.323305993" value="รั่วไหล"><label>รั่วไหล</label></div><div class="radio-item radio-item-other" onclick="selectRadio(this)" data-other-target="fuelLeakOther"><div class="flex items-center gap-2 w-full"><input type="radio" name="entry.323305993" value="__other_option__"><label>อื่นๆ…</label></div><input type="text" id="fuelLeakOther" name="entry.323305993.other_option_response" class="other-input form-input w-full mt-2 hidden" placeholder="ระบุ..."></div></div></div>
                        <div class="form-group"><label class="form-label block mb-2">Lubricating Oil Leaks / การรั่วไหลของน้ำมันหล่อลื่น</label><div class="radio-group flex flex-wrap gap-4"><div class="radio-item" onclick="selectRadio(this)"><input type="radio" name="entry.1072480311" value="ปกติ"><label>ปกติ</label></div><div class="radio-item" onclick="selectRadio(this)"><input type="radio" name="entry.1072480311" value="รั่วไหล"><label>รั่วไหล</label></div><div class="radio-item radio-item-other" onclick="selectRadio(this)" data-other-target="lubLeakOther"><div class="flex items-center gap-2 w-full"><input type="radio" name="entry.1072480311" value="__other_option__"><label>อื่นๆ…</label></div><input type="text" id="lubLeakOther" name="entry.1072480311.other_option_response" class="other-input form-input w-full mt-2 hidden" placeholder="ระบุ..."></div></div></div>
                        <div class="form-group"><label class="form-label block mb-2">Cooling Water Leaks / การรั่วไหลของน้ำระบายความร้อน</label><div class="radio-group flex flex-wrap gap-4"><div class="radio-item" onclick="selectRadio(this)"><input type="radio" name="entry.1607591057" value="ปกติ"><label>ปกติ</label></div><div class="radio-item" onclick="selectRadio(this)"><input type="radio" name="entry.1607591057" value="รั่วไหล"><label>รั่วไหล</label></div><div class="radio-item radio-item-other" onclick="selectRadio(this)" data-other-target="coolLeakOther"><div class="flex items-center gap-2 w-full"><input type="radio" name="entry.1607591057" value="__other_option__"><label>อื่นๆ…</label></div><input type="text" id="coolLeakOther" name="entry.1607591057.other_option_response" class="other-input form-input w-full mt-2 hidden" placeholder="ระบุ..."></div></div></div>
                    </div>
                </div>

                <div class="section-card p-4 sm:p-7 mb-8">
                    <div class="section-header border-b-2 border-gray-100 pb-4 mb-6"><h2 class="section-title text-lg sm:text-xl font-bold text-gray-800">🔧 ชิ้นส่วนเครื่องกล</h2></div>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-7">
                        <div class="form-group"><label class="form-label block mb-2">Tightness Of Bolts And Nuts / ตรวจเช็คสภาพของสลักและน๊อต</label><div class="radio-group flex flex-wrap gap-4"><div class="radio-item" onclick="selectRadio(this)"><input type="radio" name="entry.719816448" value="น็อตขันแน่นปกติ"><label>น็อตขันแน่นปกติ</label></div><div class="radio-item" onclick="selectRadio(this)"><input type="radio" name="entry.719816448" value="น็อตไม่แน่น"><label>น็อตไม่แน่น</label></div><div class="radio-item radio-item-other" onclick="selectRadio(this)" data-other-target="boltsOther"><div class="flex items-center gap-2 w-full"><input type="radio" name="entry.719816448" value="__other_option__"><label>อื่นๆ…</label></div><input type="text" id="boltsOther" name="entry.719816448.other_option_response" class="other-input form-input w-full mt-2 hidden" placeholder="ระบุ..."></div></div></div>
                        <div class="form-group"><label class="form-label block mb-2">Tightness Of Electrical Terminal Connections / ตรวจเช็คสภาพของขั้วต่อสายไฟฟ้า</label><div class="radio-group flex flex-wrap gap-4"><div class="radio-item" onclick="selectRadio(this)"><input type="radio" name="entry.737194412" value="ขั้วสายแน่นปกติ"><label>ขั้วสายแน่นปกติ</label></div><div class="radio-item" onclick="selectRadio(this)"><input type="radio" name="entry.737194412" value="ขั้วสายไม่แน่น"><label>ขั้วสายไม่แน่น</label></div><div class="radio-item radio-item-other" onclick="selectRadio(this)" data-other-target="elecOther"><div class="flex items-center gap-2 w-full"><input type="radio" name="entry.737194412" value="__other_option__"><label>อื่นๆ…</label></div><input type="text" id="elecOther" name="entry.737194412.other_option_response" class="other-input form-input w-full mt-2 hidden" placeholder="ระบุ..."></div></div></div>
                        <div class="form-group"><label class="form-label block mb-2">Air Cleaner / ตรวจเช็คไส้กรองอากาศ</label><div class="radio-group flex flex-wrap gap-4"><div class="radio-item" onclick="selectRadio(this)"><input type="radio" name="entry.1182164809" value="ปกติ"><label>ปกติ</label></div><div class="radio-item" onclick="selectRadio(this)"><input type="radio" name="entry.1182164809" value="ไส้กรองตัน"><label>ไส้กรองตัน</label></div><div class="radio-item radio-item-other" onclick="selectRadio(this)" data-other-target="airOther"><div class="flex items-center gap-2 w-full"><input type="radio" name="entry.1182164809" value="__other_option__"><label>อื่นๆ…</label></div><input type="text" id="airOther" name="entry.1182164809.other_option_response" class="other-input form-input w-full mt-2 hidden" placeholder="ระบุ..."></div></div></div>
                        <div class="form-group"><label class="form-label block mb-2">Fuel Filter Element / ตรวจเช็คไส้กรองน้ำมัน(STD. ตันหรือไม่ตัน)</label><div class="radio-group flex flex-wrap gap-4"><div class="radio-item" onclick="selectRadio(this)"><input type="radio" name="entry.950885152" value="ไม่ตัน"><label>ไม่ตัน</label></div><div class="radio-item" onclick="selectRadio(this)"><input type="radio" name="entry.950885152" value="ตัน"><label>ตัน</label></div><div class="radio-item radio-item-other" onclick="selectRadio(this)" data-other-target="fuelOther"><div class="flex items-center gap-2 w-full"><input type="radio" name="entry.950885152" value="__other_option__"><label>อื่นๆ…</label></div><input type="text" id="fuelOther" name="entry.950885152.other_option_response" class="other-input form-input w-full mt-2 hidden" placeholder="ระบุ..."></div></div></div>
                    </div>
                </div>

                <div class="section-card p-4 sm:p-7 mb-8">
                    <div class="section-header border-b-2 border-gray-100 pb-4 mb-6"><h2 class="section-title text-lg sm:text-xl font-bold text-gray-800">⚙️ ระบบปั๊ม</h2></div>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-7">
                        <div class="form-group"><label class="form-label block mb-2">Check Water Suction Tube / เช็คน้ำในท่อดูดปั๊มน้ำ</label><div class="radio-group flex flex-wrap gap-4"><div class="radio-item" onclick="selectRadio(this)"><input type="radio" name="entry.824942619" value="ใช้งานได้ปกติ"><label>ใช้งานได้ปกติ</label></div><div class="radio-item" onclick="selectRadio(this)"><input type="radio" name="entry.824942619" value="มีรอยรั่ว"><label>มีรอยรั่ว</label></div><div class="radio-item radio-item-other" onclick="selectRadio(this)" data-other-target="suctionOther"><div class="flex items-center gap-2 w-full"><input type="radio" name="entry.824942619" value="__other_option__"><label>อื่นๆ…</label></div><input type="text" id="suctionOther" name="entry.824942619.other_option_response" class="other-input form-input w-full mt-2 hidden" placeholder="ระบุ..."></div></div></div>
                        <div class="form-group"><label class="form-label block mb-2">Jocky Pump Test / ทดสอบการทำงานของปั๊มรักษาแรงดัน</label><div class="radio-group flex flex-wrap gap-4"><div class="radio-item" onclick="selectRadio(this)"><input type="radio" name="entry.1298699451" value="ปกติ"><label>ปกติ</label></div><div class="radio-item" onclick="selectRadio(this)"><input type="radio" name="entry.1298699451" value="ผิดปกติ"><label>ผิดปกติ</label></div><div class="radio-item radio-item-other" onclick="selectRadio(this)" data-other-target="jockyPumpOther"><div class="flex items-center gap-2 w-full"><input type="radio" name="entry.1298699451" value="__other_option__"><label>อื่นๆ…</label></div><input type="text" id="jockyPumpOther" name="entry.1298699451.other_option_response" class="other-input form-input w-full mt-2 hidden" placeholder="ระบุ..."></div></div></div>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-7 mt-7">
                        <div class="form-group"><label class="form-label block mb-2">แรงดันน้ำในท่อส่งน้ำดับเพลิงที่ปั๊มเริ่มทำงาน(STD. 100 PSI)</label><input type="number" name="entry.170318696" class="form-input w-full" placeholder="STD. 100 PSI"></div>
                        <div class="form-group"><label class="form-label block mb-2">แรงดันน้ำในท่อส่งน้ำดับเพลิงที่ปั๊มหยุดทำงาน (STD. 120-130 PSI)</label><input type="number" name="entry.835390568" class="form-input w-full" placeholder="STD. 120-130 PSI"></div>
                    </div>
                </div>

                <div class="section-card p-4 sm:p-7 mb-8">
                    <div class="section-header border-b-2 border-gray-100 pb-4 mb-6"><h2 class="section-title text-lg sm:text-xl font-bold text-gray-800">🚗 สมรรถนะเครื่องยนต์</h2></div>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-7">
                        <div class="form-group">
                            <label class="form-label block mb-2">V Belts Condition / ตรวจเช็คการทำงานของสายพาน</label>
                            <div class="radio-group flex flex-wrap gap-4">
                                <div class="radio-item" onclick="selectRadio(this)"><input type="radio" name="entry.380068157" value="ปกติ"><label>ปกติ</label></div>
                                <div class="radio-item" onclick="selectRadio(this)"><input type="radio" name="entry.380068157" value="สายพานหย่อน"><label>สายพานหย่อน</label></div>
                                <div class="radio-item radio-item-other" onclick="selectRadio(this)" data-other-target="vbeltOther"><div class="flex items-center gap-2 w-full"><input type="radio" name="entry.380068157" value="__other_option__"><label>อื่นๆ…</label></div><input type="text" id="vbeltOther" name="entry.380068157.other_option_response" class="other-input form-input w-full mt-2 hidden" placeholder="ระบุ..."></div>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label block mb-2">Running Hours / จำนวนเวลาในการทำงาน (นาที)</label>
                            <input type="text" name="entry.693422880" class="form-input w-full" placeholder="เช่น 15">
                        </div>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-7 mt-7">
                        <div class="form-group"><label class="form-label block mb-2">Engine RPM / ความเร็วรอบของเครื่องยนต์ (STD. 2,300 RPM)</label><input type="number" name="entry.1405771031" class="form-input w-full" placeholder="STD. 2,300 RPM"></div>
                        <div class="form-group"><label class="form-label block mb-2">Lubricating Oil Pressure / แรงดันของน้ำมันหล่อลื่น (STD.250-750Kpa)</label><input type="number" name="entry.1301900075" class="form-input w-full" placeholder="STD. 250-750Kpa"></div>
                        <div class="form-group"><label class="form-label block mb-2">Lubricating Oil Temperature /อุณหภูมิของน้ำมันหล่อลื่น( °C)</label><input type="number" name="entry.1118394468" class="form-input w-full" placeholder="หน่วย °C"></div>
                        <div class="form-group"><label class="form-label block mb-2">Cooling Water Pressure / แรงดันของน้ำระบายความร้อน ( °C)</label><input type="number" name="entry.278367378" class="form-input w-full" placeholder="หน่วย °C"></div>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-7 mt-7">
                        <div class="form-group"><label class="form-label block mb-2">Cooling Water Temperature / อุณภูมิของน้ำระบายความร้อน(STD. 80-100 °C)</label><input type="number" name="entry.1127101964" class="form-input w-full" placeholder="STD. 80-100 °C"></div>
                        <div class="form-group"><label class="form-label block mb-2">แรงดันน้ำในท่อส่งน้ำดับเพลิงที่เครื่องยนต์เริ่มทำงาน (STD. 99 psi)</label><input type="number" name="entry.797055912" class="form-input w-full" placeholder="STD. 99 psi"></div>
                        <div class="form-group"><label class="form-label block mb-2">แรงดันน้ำในท่อส่งน้ำดับเพลิงขณะเครื่องยนต์ทำงาน (STD. 120 psi)</label><input type="number" name="entry.1506477567" class="form-input w-full" placeholder="STD. 120 psi"></div>
                    </div>
                </div>

                <div class="section-card p-4 sm:p-7 mb-8">
                    <div class="section-header border-b-2 border-gray-100 pb-4 mb-6"><h2 class="section-title text-lg sm:text-xl font-bold text-gray-800">💡 สถานะระบบ</h2></div>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-7">
                        <div class="form-group"><label class="form-label block mb-2">การทำงานของไฟแสดงผล</label><div class="radio-group flex flex-wrap gap-4"><div class="radio-item" onclick="selectRadio(this)"><input type="radio" name="entry.1316882575" value="ไฟติดครบ"><label>ไฟติดครบ</label></div><div class="radio-item" onclick="selectRadio(this)"><input type="radio" name="entry.1316882575" value="ไฟติดไม่ครบ"><label>ไฟติดไม่ครบ</label></div><div class="radio-item radio-item-other" onclick="selectRadio(this)" data-other-target="ไฟแสดงผลOther"><div class="flex items-center gap-2 w-full"><input type="radio" name="entry.1316882575" value="__other_option__"><label>อื่นๆ…</label></div><input type="text" id="ไฟแสดงผลOther" name="entry.1316882575.other_option_response" class="other-input form-input w-full mt-2 hidden" placeholder="ระบุ..."></div></div></div>
                        <div class="form-group"><label class="form-label block mb-2">Check Vibrations / ตรวจเช็คการสั่นของเครื่องยนต์</label><div class="radio-group flex flex-wrap gap-4"><div class="radio-item" onclick="selectRadio(this)"><input type="radio" name="entry.628997006" value="ปกติ"><label>ปกติ</label></div><div class="radio-item" onclick="selectRadio(this)"><input type="radio" name="entry.628997006" value="ผิดปกติ(เครื่องสั่นมาก)"><label>ผิดปกติ</label></div><div class="radio-item radio-item-other" onclick="selectRadio(this)" data-other-target="vibrationsOther"><div class="flex items-center gap-2 w-full"><input type="radio" name="entry.628997006" value="__other_option__"><label>อื่นๆ…</label></div><input type="text" id="vibrationsOther" name="entry.628997006.other_option_response" class="other-input form-input w-full mt-2 hidden" placeholder="ระบุ..."></div></div></div>
                        <div class="form-group"><label class="form-label block mb-2">Check All Moving Parts For Abnormal Sounds / ตรวจเช็คส่วนที่มีการเคลื่อนที่และความผิดปกติของเสียง </label><div class="radio-group flex flex-wrap gap-4"><div class="radio-item" onclick="selectRadio(this)"><input type="radio" name="entry.1209254361" value="ไม่มีเสียงผิดปกติ"><label>ปกติ</label></div><div class="radio-item" onclick="selectRadio(this)"><input type="radio" name="entry.1209254361" value="มีเสียงผิดปกติ"><label>ผิดปกติ</label></div><div class="radio-item radio-item-other" onclick="selectRadio(this)" data-other-target="soundsOther"><div class="flex items-center gap-2 w-full"><input type="radio" name="entry.1209254361" value="__other_option__"><label>อื่นๆ…</label></div><input type="text" id="soundsOther" name="entry.1209254361.other_option_response" class="other-input form-input w-full mt-2 hidden" placeholder="ระบุ..."></div></div></div>
                    </div>
                    <div class="form-group mt-7"><label class="form-label block mb-2">Flow Switch / การทำงานของสวิทช์</label><div class="radio-group flex flex-wrap gap-4"><div class="radio-item" onclick="selectRadio(this)"><input type="radio" name="entry.950605992" value="ทำงานปกติ"><label>ทำงานปกติ</label></div><div class="radio-item" onclick="selectRadio(this)"><input type="radio" name="entry.950605992" value="ทำงานผิดปกติ"><label>ทำงานผิดปกติ</label></div><div class="radio-item radio-item-other" onclick="selectRadio(this)" data-other-target="flowSwitchOther"><div class="flex items-center gap-2 w-full"><input type="radio" name="entry.950605992" value="__other_option__"><label>อื่นๆ…</label></div><input type="text" id="flowSwitchOther" name="entry.950605992.other_option_response" class="other-input form-input w-full mt-2 hidden" placeholder="ระบุ..."></div></div></div>
                </div>

                <div class="section-card p-4 sm:p-7 mb-8">
                    <div class="section-header border-b-2 border-gray-100 pb-4 mb-6"><h2 class="section-title text-lg sm:text-xl font-bold text-gray-800">📊 การวัดเพิ่มเติม</h2></div>
                    <div class="grid grid-cols-1 gap-y-7">
                        <div class="form-group"><label class="form-label block mb-2">การทดสอบ Jocky Pump เปิดวาล์วลดแรงดันน้ำในระบบท่อส่งน้ำดับเพลิง บันทึกแรงดันปั๊มทำงานงาน(psi)</label><input type="number" name="entry.700036978" class="form-input w-full" placeholder="..."></div>
                        <div class="form-group"><label class="form-label block mb-2">การทดสอบ Jocky Pump เปิดวาล์วลดแรงดันน้ำในระบบท่อส่งน้ำดับเพลิง บันทึกแรงดันปั๊มหยุดทำงาน(psi)</label><input type="number" name="entry.174910325" class="form-input w-full" placeholder="..."></div>
                        <div class="form-group"><label class="form-label block mb-2">การทดสอบ Engine Fire Pump  ปิดสวิทช์ควบคุม Jocky Pumpเปิดวาล์วลดแรงดันน้ำในระบบท่อส่งน้ำดับเพลิง บันทึกแรงดันเครื่องยนต์ทำงาน(psi)</label><input type="number" name="entry.2077235529" class="form-input w-full" placeholder="..."></div>
                        <div class="form-group"><label class="form-label block mb-2">การทดสอบ Engine Fire Pump  ปิดสวิทช์ควบคุม Jocky Pumpเปิดวาล์วลดแรงดันน้ำในระบบท่อส่งน้ำดับเพลิง บันทึกแรงดันสูงสุด(psi)</label><input type="number" name="entry.491301014" class="form-input w-full" placeholder="..."></div>
                    </div>
                </div>

                <div class="section-card p-4 sm:p-7 mb-8">
                    <div class="section-header border-b-2 border-gray-100 pb-4 mb-6"><h2 class="section-title text-lg sm:text-xl font-bold text-gray-800">🔨 กิจกรรมการบำรุงรักษา</h2></div>
                    <div class="grid grid-cols-1 gap-y-7">
                        <div class="form-group"><label class="form-label block mb-2">General Cleaning/ทำความสะอาดทั่วไป (STD.ทำความสะอาด)</label><div class="radio-group flex flex-wrap gap-4"><div class="radio-item" onclick="selectRadio(this)"><input type="radio" name="entry.1459189432" value="ทำความสะอาด"><label>ทำความสะอาด</label></div></div></div>
                        <div class="form-group"><label class="form-label block mb-2">V Belts Condition/ตรวจเช็คการทำงานของสายพาน(STD.ปกติหรือฉีกขาด)</label><div class="radio-group flex flex-wrap gap-4"><div class="radio-item" onclick="selectRadio(this)"><input type="radio" name="entry.764561274" value="ปกติ"><label>ปกติ</label></div><div class="radio-item" onclick="selectRadio(this)"><input type="radio" name="entry.764561274" value="ฉีกขาด"><label>ฉีกขาด</label></div><div class="radio-item radio-item-other" onclick="selectRadio(this)" data-other-target="vbeltMaintOther"><div class="flex items-center gap-2 w-full"><input type="radio" name="entry.764561274" value="__other_option__"><label>อื่นๆ…</label></div><input type="text" id="vbeltMaintOther" name="entry.764561274.other_option_response" class="other-input form-input w-full mt-2 hidden" placeholder="ระบุ..."></div></div></div>
                        <div class="form-group"><label class="form-label block mb-2">Record Running Hours/บันทึกจำนวนเวลาที่ทำงาน(STD.Hour)</label><input type="number" name="entry.1309858519" class="form-input w-full" placeholder="หน่วย Hour"></div>
                        <div class="form-group"><label class="form-label block mb-2">Battery Charging Volt./แรงดันการชาร์จแบตเตอรี่(STD.ไม่ต่ำกว่า12v.)</label><input type="number" name="entry.1833812342" class="form-input w-full" step="0.1" placeholder="STD. ไม่ต่ำกว่า 12v"></div>
                        <div class="form-group"><label class="form-label block mb-2">Test Battery/ทดสอบแบตเตอรี่(STD.ไม่ต่ำกว่า12VDC)</label><input type="number" name="entry.1502505224" class="form-input w-full" step="0.1" placeholder="STD. ไม่ต่ำกว่า 12VDC"></div>
                        <div class="form-group"><label class="form-label block mb-2">Change Ludricating Oil/เปลี่ยนถ่ายน้ำมันหล่อลื่น(STD.ว/ด/ป)</label><input type="date" name="entry.376703834" class="form-input w-full"></div>
                        <div class="form-group"><label class="form-label block mb-2">Change Ludricating Oil Filter/เปลี่ยนถ่ายกรองน้ำมันหล่อลื่น(STD.ว/ด/ป)</label><input type="date" name="entry.550562469" class="form-input w-full"></div>
                        <div class="form-group"><label class="form-label block mb-2">Change Air Filter/เปลี่ยนใส้กรองอากาศ(STD.ว/ด/ป)</label><input type="date" name="entry.964740712" class="form-input w-full"></div>
                    </div>
                </div>

                <div class="section-card p-4 sm:p-7 mb-8">
                    <div class="section-header border-b-2 border-gray-100 pb-4 mb-6"><h2 class="section-title text-lg sm:text-xl font-bold text-gray-800">⚡ ระบบไฟฟ้า</h2></div>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-7">
                        <div class="form-group"><label class="form-label block mb-2">Inspection For Any Sign Of Wburnmarks,Oxidation,Abnormal Hissing Sound & Smell/ตรวจสอบความผิดปกติของเสียงและกลิ่น(STD.เสียงดัง/ไม่เหม็น)</label><div class="radio-group flex flex-wrap gap-4"><div class="radio-item" onclick="selectRadio(this)"><input type="radio" name="entry.1952860784" value="ปกติ"><label>ปกติ</label></div><div class="radio-item" onclick="selectRadio(this)"><input type="radio" name="entry.1952860784" value="ผิดปกติ"><label>ผิดปกติ</label></div><div class="radio-item radio-item-other" onclick="selectRadio(this)" data-other-target="sound_smellOther"><div class="flex items-center gap-2 w-full"><input type="radio" name="entry.1952860784" value="__other_option__"><label>อื่นๆ…</label></div><input type="text" id="sound_smellOther" name="entry.1952860784.other_option_response" class="other-input form-input w-full mt-2 hidden" placeholder="ระบุ..."></div></div></div>
                        <div class="form-group"><label class="form-label block mb-2">Check Status Of All Indication/ตรวจเช็คสภาพของ Indicator ต่างๆของ Circuit Brecaker(STD.ใช้งานได้)</label><div class="radio-group flex flex-wrap gap-4"><div class="radio-item" onclick="selectRadio(this)"><input type="radio" name="entry.1304076428" value="ใช้งานได้"><label>ใช้งานได้</label></div><div class="radio-item" onclick="selectRadio(this)"><input type="radio" name="entry.1304076428" value="ผิดปกติ"><label>ผิดปกติ</label></div><div class="radio-item radio-item-other" onclick="selectRadio(this)" data-other-target="indicatorOther"><div class="flex items-center gap-2 w-full"><input type="radio" name="entry.1304076428" value="__other_option__"><label>อื่นๆ…</label></div><input type="text" id="indicatorOther" name="entry.1304076428.other_option_response" class="other-input form-input w-full mt-2 hidden" placeholder="ระบุ..."></div></div></div>
                        <div class="form-group"><label class="form-label block mb-2">Check For General Operation & Condition/ตรวจสอบสภาพและการทำงานทั่วไป(STD.ใช้งานได้)</label><div class="radio-group flex flex-wrap gap-4"><div class="radio-item" onclick="selectRadio(this)"><input type="radio" name="entry.1601277291" value="ใช้งานได้"><label>ใช้งานได้</label></div><div class="radio-item" onclick="selectRadio(this)"><input type="radio" name="entry.1601277291" value="ผิดปกติ"><label>ผิดปกติ</label></div><div class="radio-item radio-item-other" onclick="selectRadio(this)" data-other-target="generalOther"><div class="flex items-center gap-2 w-full"><input type="radio" name="entry.1601277291" value="__other_option__"><label>อื่นๆ…</label></div><input type="text" id="generalOther" name="entry.1601277291.other_option_response" class="other-input form-input w-full mt-2 hidden" placeholder="ระบุ..."></div></div></div>
                        <div class="form-group"><label class="form-label block mb-2">Check Casing Condition/ตรวจสอบสภาพโครงสร้างของอุปกรณ์(STD.ใช้งานได้)</label><div class="radio-group flex flex-wrap gap-4"><div class="radio-item" onclick="selectRadio(this)"><input type="radio" name="entry.851234898" value="ใช้งานได้"><label>ใช้งานได้</label></div><div class="radio-item" onclick="selectRadio(this)"><input type="radio" name="entry.851234898" value="ผิดปกติ"><label>ผิดปกติ</label></div><div class="radio-item radio-item-other" onclick="selectRadio(this)" data-other-target="casingOther"><div class="flex items-center gap-2 w-full"><input type="radio" name="entry.851234898" value="__other_option__"><label>อื่นๆ…</label></div><input type="text" id="casingOther" name="entry.851234898.other_option_response" class="other-input form-input w-full mt-2 hidden" placeholder="ระบุ..."></div></div></div>
                        <div class="form-group"><label class="form-label block mb-2">Dedusting/ทำการทำความสะอาดภายนอกตามจุดต่างๆที่มีฝุ่นละออง(STD.ทำความสะอาด)</label><div class="radio-group flex flex-wrap gap-4"><div class="radio-item" onclick="selectRadio(this)"><input type="radio" name="entry.362638249" value="ทำความสะอาด"><label>ทำความสะอาด</label></div><div class="radio-item radio-item-other" onclick="selectRadio(this)" data-other-target="dustOther"><div class="flex items-center gap-2 w-full"><input type="radio" name="entry.362638249" value="__other_option__"><label>อื่นๆ…</label></div><input type="text" id="dustOther" name="entry.362638249.other_option_response" class="other-input form-input w-full mt-2 hidden" placeholder="ระบุ..."></div></div></div>
                        <div class="form-group"><label class="form-label block mb-2">Body,Cubicle&Racking Cleaning / ทำความสะอาดภายในและชิ้นส่วนเมคคานิคต่าง ๆ(STD.ทำความสะอาด)</label><div class="radio-group flex flex-wrap gap-4"><div class="radio-item" onclick="selectRadio(this)"><input type="radio" name="entry.1151340514" value="ทำความสะอาด"><label>ทำความสะอาด</label></div><div class="radio-item radio-item-other" onclick="selectRadio(this)" data-other-target="bodyOther"><div class="flex items-center gap-2 w-full"><input type="radio" name="entry.1151340514" value="__other_option__"><label>อื่นๆ…</label></div><input type="text" id="bodyOther" name="entry.1151340514.other_option_response" class="other-input form-input w-full mt-2 hidden" placeholder="ระบุ..."></div></div></div>
                        <div class="form-group"><label class="form-label block mb-2">Insulation Resistance Test & Grounding Checked / ตรวจสอบฉนวนและกราวด์(STD.ปกติหรือเสื่อมสภาพ)</label><div class="radio-group flex flex-wrap gap-4"><div class="radio-item" onclick="selectRadio(this)"><input type="radio" name="entry.1956843408" value="ปกติ"><label>ปกติ</label></div><div class="radio-item" onclick="selectRadio(this)"><input type="radio" name="entry.1956843408" value="เสื่อมสภาพ"><label>เสื่อมสภาพ</label></div></div></div>
                        <div class="form-group"><label class="form-label block mb-2">Tightening Of All Electrical Connection / ตรวจขันน๊อตล็อกขั้วสายไฟและจุดต่อต่างๆ (STD.ขันแน่น)</label><div class="radio-group flex flex-wrap gap-4"><div class="radio-item" onclick="selectRadio(this)"><input type="radio" name="entry.1745325661" value="ขันแน่น"><label>ขันแน่น</label></div><div class="radio-item" onclick="selectRadio(this)"><input type="radio" name="entry.1745325661" value="ผิดปกติ"><label>ผิดปกติ</label></div><div class="radio-item radio-item-other" onclick="selectRadio(this)" data-other-target="tightenOther"><div class="flex items-center gap-2 w-full"><input type="radio" name="entry.1745325661" value="__other_option__"><label>อื่นๆ…</label></div><input type="text" id="tightenOther" name="entry.1745325661.other_option_response" class="other-input form-input w-full mt-2 hidden" placeholder="ระบุ..."></div></div></div>
                        <div class="form-group"><label class="form-label block mb-2">Lubricate Mechanical Parts / ทำการหล่อลื่นตามชิ้นส่วนแมคคานิคต่าง ๆ(STD.ไม่มีในระบบ)</label><div class="radio-group flex flex-wrap gap-4"><div class="radio-item" onclick="selectRadio(this)"><input type="radio" name="entry.1547716680" value="ไม่มีในระบบ"><label>ไม่มีในระบบ</label></div><div class="radio-item radio-item-other" onclick="selectRadio(this)" data-other-target="lubricateOther"><div class="flex items-center gap-2 w-full"><input type="radio" name="entry.1547716680" value="__other_option__"><label>อื่นๆ…</label></div><input type="text" id="lubricateOther" name="entry.1547716680.other_option_response" class="other-input form-input w-full mt-2 hidden" placeholder="ระบุ..."></div></div></div>
                    </div>
                </div>

                <div class="section-card p-4 sm:p-7 mb-8">
                    <div class="section-header border-b-2 border-gray-100 pb-4 mb-6"><h2 class="section-title text-lg sm:text-xl font-bold text-gray-800">🛡️ ความปลอดภัยและการป้องกัน</h2></div>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-7">
                        <div class="form-group"><label class="form-label block mb-2">Check All Safety Devices / ตรวจสอบอุปกรณ์ระบบความปลอดภัย(STD.พร้อมใช้งาน)</label><div class="radio-group flex flex-wrap gap-4"><div class="radio-item" onclick="selectRadio(this)"><input type="radio" name="entry.498232465" value="พร้อมใช้งาน"><label>พร้อมใช้งาน</label></div><div class="radio-item" onclick="selectRadio(this)"><input type="radio" name="entry.498232465" value="ไม่พร้อมใช้งาน"><label>ไม่พร้อมใช้งาน</label></div><div class="radio-item radio-item-other" onclick="selectRadio(this)" data-other-target="safetyOther"><div class="flex items-center gap-2 w-full"><input type="radio" name="entry.498232465" value="__other_option__"><label>อื่นๆ…</label></div><input type="text" id="safetyOther" name="entry.498232465.other_option_response" class="other-input form-input w-full mt-2 hidden" placeholder="ระบุ..."></div></div></div>
                        <div class="form-group"><label class="form-label block mb-2">Check Fuses & Protection Device / ตรวจสอบฟิวส์และอุปกรณ์ป้องกันต่าง ๆ(STD.พร้อมใช้งาน)</label><div class="radio-group flex flex-wrap gap-4"><div class="radio-item" onclick="selectRadio(this)"><input type="radio" name="entry.1443945119" value="พร้อมใช้งาน"><label>พร้อมใช้งาน</label></div><div class="radio-item" onclick="selectRadio(this)"><input type="radio" name="entry.1443945119" value="ไม่พร้อมใช้งาน"><label>ไม่พร้อมใช้งาน</label></div><div class="radio-item radio-item-other" onclick="selectRadio(this)" data-other-target="fusesOther"><div class="flex items-center gap-2 w-full"><input type="radio" name="entry.1443945119" value="__other_option__"><label>อื่นๆ…</label></div><input type="text" id="fusesOther" name="entry.1443945119.other_option_response" class="other-input form-input w-full mt-2 hidden" placeholder="ระบุ..."></div></div></div>
                        <div class="form-group"><label class="form-label block mb-2">Tightening Busbar Supports / ตรวจน๊อตยึดแท่งบัสบาร์(STD.ไม่มีในระบบ)</label><div class="radio-group flex flex-wrap gap-4"><div class="radio-item" onclick="selectRadio(this)"><input type="radio" name="entry.614621971" value="ไม่มีในระบบ"><label>ไม่มีในระบบ</label></div><div class="radio-item radio-item-other" onclick="selectRadio(this)" data-other-target="busbarOther"><div class="flex items-center gap-2 w-full"><input type="radio" name="entry.614621971" value="__other_option__"><label>อื่นๆ…</label></div><input type="text" id="busbarOther" name="entry.614621971.other_option_response" class="other-input form-input w-full mt-2 hidden" placeholder="ระบุ..."></div></div></div>
                        <div class="form-group"><label class="form-label block mb-2">Check Communication for Building Automation System/ตรวจสอบการทำงานในสภาวะต่างๆ ในระบบอาคารอัติโนมัติ(STD.ใช้งานได้)</label><div class="radio-group flex flex-wrap gap-4"><div class="radio-item" onclick="selectRadio(this)"><input type="radio" name="entry.569091221" value="ใช้งานได้"><label>ใช้งานได้</label></div><div class="radio-item" onclick="selectRadio(this)"><input type="radio" name="entry.569091221" value="ไม่พร้อมใช้งาน"><label>ไม่พร้อมใช้งาน</label></div><div class="radio-item radio-item-other" onclick="selectRadio(this)" data-other-target="buildingOther"><div class="flex items-center gap-2 w-full"><input type="radio" name="entry.569091221" value="__other_option__"><label>อื่นๆ…</label></div><input type="text" id="buildingOther" name="entry.569091221.other_option_response" class="other-input form-input w-full mt-2 hidden" placeholder="ระบุ..."></div></div></div>
                        <div class="form-group"><label class="form-label block mb-2">Check Communication for RUUor DDC to Building Automation System and Cleaning/ตรวจสอบการสื่อสารระหว่างอุปกรณ์ต่อพ่วงกับระบบอาคารอัตโนมัติพร้อมทั้งทำความสะอาด(STD.ทำความสะอาด)</label><div class="radio-group flex flex-wrap gap-4"><div class="radio-item" onclick="selectRadio(this)"><input type="radio" name="entry.673310831" value="ทำความสะอาด"><label>ทำความสะอาด</label></div><div class="radio-item radio-item-other" onclick="selectRadio(this)" data-other-target="commOther"><div class="flex items-center gap-2 w-full"><input type="radio" name="entry.673310831" value="__other_option__"><label>อื่นๆ…</label></div><input type="text" id="commOther" name="entry.673310831.other_option_response" class="other-input form-input w-full mt-2 hidden" placeholder="ระบุ..."></div></div></div>
                        <div class="form-group"><label class="form-label block mb-2">Check Status Lamp Show for Annuciator Panel/ตรวจสอบหลอดไฟแสดงการทำงานในสภาวะต่าง ๆ(STD.ไฟติดครบ)</label><div class="radio-group flex flex-wrap gap-4"><div class="radio-item" onclick="selectRadio(this)"><input type="radio" name="entry.1022996900" value="ไฟติดครบ"><label>ไฟติดครบ</label></div><div class="radio-item radio-item-other" onclick="selectRadio(this)" data-other-target="lampOther"><div class="flex items-center gap-2 w-full"><input type="radio" name="entry.1022996900" value="__other_option__"><label>อื่นๆ…</label></div><input type="text" id="lampOther" name="entry.1022996900.other_option_response" class="other-input form-input w-full mt-2 hidden" placeholder="ระบุ..."></div></div></div>
                    </div>
                    <div class="form-group mt-7"><label class="form-label block mb-2">Record Voltage / บันทึกค่าแรงดัน(STD.ไม่ต่ำกว่า 12v)</label><input type="number" name="entry.209108764" class="form-input w-full" step="0.1" placeholder="STD. ไม่ต่ำกว่า 12v"></div>
                </div>

                <div class="section-card p-4 sm:p-7 mb-8" style="margin-bottom: 150px;">
                    <div class="section-header border-b-2 border-gray-100 pb-4 mb-6"><h2 class="section-title text-lg sm:text-xl font-bold text-gray-800">📝 ปัญหาและข้อเสนอแนะ</h2></div>
                    <div class="grid grid-cols-1 gap-7">
                        <div class="form-group"><label class="form-label block mb-2">ISSUE</label><p class="helper-text">ปัญหาที่พบ หากไม่พบปัญหาไม่ต้องกรอกข้อมูล</p><textarea name="entry.129342865" class="form-textarea w-full" rows="4" placeholder="อธิบายปัญหาที่พบ..."></textarea></div>
                        <div class="form-group"><label class="form-label block mb-2">CONDITION</label><p class="helper-text">แนวทางการแก้ไขปัญหา(หากไม่มีปัญหาไม่ต้องกรอกข้อมูล)</p><textarea name="entry.690163791" class="form-textarea w-full" rows="4" placeholder="อธิบายวิธีการแก้ไขปัญหา..."></textarea></div>
                        <div class="form-group"><label class="form-label block mb-2">HISTORY RECCORD</label><p class="helper-text">บันทึกประวัติการแก้ไข</p><textarea name="entry.788703385" class="form-textarea w-full" rows="3" placeholder="บันทึกประวัติการซ่อมแซม..."></textarea></div>
                        <div class="form-group"><label class="form-label block mb-2">วันตรวจเช็ครอบถัดไป</label><input type="date" name="entry.298726690" class="form-input w-full"></div>
                    </div>
                </div>

                <div class="action-buttons hidden"></div>

                <div class="fab-container">
                    <button type="button" id="fab-toggle" class="relative">
                        <svg id="fab-toggle-icon" class="h-8 w-8" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" stroke="currentColor">
                            <g>
                                <path d="M12 12H12.01M12 6H12.01M12 18H12.01M13 12C13 12.5523 12.5523 13 12 13C11.4477 13 11 12.5523 11 12C11 11.4477 11.4477 11 12 11C12.5523 11 13 11.4477 13 12ZM13 6C13 6.55228 12.5523 7 12 7C11.4477 7 11 6.55228 11 6C11 5.44772 11.4477 5 12 5C12.5523 5 13 5.44772 13 6ZM13 18C13 18.5523 12.5523 19 12 19C11.4477 19 11 18.5523 11 18C11 17.4477 11.4477 17 12 17C12.5523 17 13 17.4477 13 18Z" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
                            </g>
                        </svg>
                    </button>
                    
                    <div id="fab-menu">
                         <div class="fab-menu-item">
                            <span class="text-sm font-semibold">ส่งออกรายงาน</span>
                            <button type="button" onclick="exportReport()" class="btn btn-export">📄</button>
                        </div>
                         <div class="fab-menu-item">
                            <span class="text-sm font-semibold">รีเซ็ตแบบฟอร์ม</span>
                            <button type="button" onclick="resetForm()" class="btn btn-red">🔄</button>
                        </div>
                         <div class="fab-menu-item">
                            <span class="text-sm font-semibold">ตรวจสอบคำตอบ</span>
                            <button type="button" onclick="previewAnswers()" class="btn btn-preview">🔍</button>
                        </div>
                        <div class="fab-menu-item">
                            <span class="text-sm font-semibold">วิเคราะห์ด้วย AI</span>
                            <button type="button" onclick="analyzeWithAI()" class="btn btn-ai">🤖</button>
                        </div>
                         <div class="fab-menu-item">
                            <span class="text-sm font-semibold">ส่งรายงาน</span>
                            <button type="submit" form="inspectionForm" class="btn btn-submit">📤</button>
                        </div>
                    </div>
                </div>
            </form>
        </div>
    </div>

    <iframe name="hidden_iframe" id="hidden_iframe" style="display:none;"></iframe>

    <dialog id="previewDialog" class="rounded-2xl shadow-xl p-0 w-11/12 max-w-2xl"></dialog>
    <dialog id="aiDialog" class="rounded-2xl shadow-xl p-0 w-11/12"></dialog>

    <script>
        // --- SCRIPT START ---
        const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbywEvusACIgXF9D9QfDdcKtatCpoGPJ9PgsHhFpfGgNJQFZGZezeJCwRYoj8HX4DgBX/exec";
        let lastAiAnalysisResult = '';

        // --- Login Logic ---
        const loginDialog = document.getElementById('loginDialog');
        const loginForm = document.getElementById('loginForm');
        const loginButton = document.getElementById('loginButton');
        const loginError = document.getElementById('loginError');
        const mainContent = document.getElementById('mainContent');
        const auroraBg = document.querySelector('.aurora-bg');

        loginDialog.showModal();
        loginDialog.addEventListener('cancel', (e) => e.preventDefault());

        loginForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            loginError.textContent = '';
            loginButton.innerHTML = '<div class="spinner"></div><span class="ml-2">กำลังตรวจสอบ...</span>';
            loginButton.disabled = true;

            const username = loginForm.username.value;
            const password = loginForm.password.value;

            try {
                const response = await fetch(SCRIPT_URL, {
                    method: 'POST',
                    mode: 'cors',
                    body: JSON.stringify({ action: 'login', username, password })
                });

                const result = await response.json();

                if (result.success) {
                    loginDialog.close();
                    if(auroraBg) auroraBg.style.display = 'none';
                    mainContent.classList.remove('hidden');
                    document.body.classList.add('loggedin');
                    initAnimations();
                    checkForSavedData();
                    initFab();
                } else {
                    loginError.textContent = result.message || 'Login failed.';
                }

            } catch (error) {
                loginError.textContent = 'ไม่สามารถเชื่อมต่อได้';
            } finally {
                loginButton.innerHTML = '<span>เข้าสู่ระบบ</span><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10.293 3.293a1 1 0 011.414 0l6 6a1 1 0 010 1.414l-6 6a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-4.293-4.293a1 1 0 010-1.414z" clip-rule="evenodd" /></svg>';
                loginButton.disabled = false;
            }
        });

        async function submitData(event) {
            event.preventDefault();
            const form = document.getElementById('inspectionForm');
            const fabSubmitButton = document.querySelector('#fab-menu .btn-submit');
            
            if (!fabSubmitButton) return;

            fabSubmitButton.disabled = true;
            fabSubmitButton.innerHTML = '<div class="spinner"></div>';
            
            saveFormDataToLocalStorage();
            
            const formData = new FormData(form);
            
            // ### FIX FOR 'OTHER OPTION' ###
            // Create a clean data object to send, processing the "other" fields correctly.
            const dataObject = {};
            for (const [key, value] of formData.entries()) {
                if (String(value).includes('__other_option__')) {
                    // This is an 'other' option. Find the corresponding text input.
                    const otherKey = `${key}.other_option_response`;
                    const otherValue = formData.get(otherKey);
                    // Assign the text value to the main key, otherwise default to "อื่นๆ" if empty
                    dataObject[key] = otherValue || 'อื่นๆ'; 
                } else if (!key.includes('.other_option_response')) {
                    // This is a regular field, not the 'other' text input itself
                    dataObject[key] = value;
                }
            }
            // Handle the special case for the operator dropdown which is not a radio group
             if (dataObject['entry.1231391232'] === '__other_option__') {
                const otherKey = 'entry.1231391232.other_option_response';
                dataObject['entry.1231391232'] = formData.get(otherKey) || 'อื่นๆ';
             }
            // ### END FIX ###


            try {
                const response = await fetch(SCRIPT_URL, {
                    method: 'POST',
                    mode: 'cors',
                    body: JSON.stringify({ action: 'submitForm', payload: dataObject })
                });

                const result = await response.json();

                if (result.success) {
                    alert('ส่งรายงานสำเร็จ!');
                    resetForm(true);
                } else {
                    alert('เกิดข้อผิดพลาดในการส่งข้อมูล: ' + (result.message || 'ไม่ทราบสาเหตุ'));
                }
            } catch (error) {
                alert('ไม่สามารถเชื่อมต่อกับเซิร์ฟเวอร์ได้ กรุณาตรวจสอบการเชื่อมต่ออินเทอร์เน็ต');
                console.error('Submission error:', error);
            } finally {
                fabSubmitButton.disabled = false;
                fabSubmitButton.innerHTML = '📤';
            }
        }

        // --- Floating Action Button (FAB) Logic ---
        function initFab() {
            const fabToggle = document.getElementById('fab-toggle');
            const fabMenu = document.getElementById('fab-menu');
            
            if (fabToggle && fabMenu) {
                fabMenu.style.display = 'none';

                fabToggle.addEventListener('click', () => {
                    fabToggle.classList.toggle('toggled');
                    if (fabToggle.classList.contains('toggled')) {
                        fabMenu.style.display = 'flex';
                    } else {
                        setTimeout(() => {
                            if (!fabToggle.classList.contains('toggled')) {
                                fabMenu.style.display = 'none';
                            }
                        }, 300); 
                    }
                });
            }
        }
        
        function selectRadio(element) {
            const radio = element.querySelector('input[type="radio"]');
            if (radio) {
                radio.checked = true;
                const parentGroup = element.closest('.form-group');
                if (parentGroup) {
                    parentGroup.querySelectorAll('.other-input').forEach(input => {
                        if (input.id !== (element.dataset.otherTarget || '')) {
                           input.classList.add('hidden');
                        }
                    });
                }
                if (element.hasAttribute('data-other-target')) {
                    const otherInput = document.getElementById(element.getAttribute('data-other-target'));
                    if (otherInput) {
                        otherInput.classList.remove('hidden');
                        otherInput.focus();
                    }
                }
            }
        }
        
        function handleOperatorChange(selectElement) {
            const otherInput = document.getElementById('operatorOther');
            if (selectElement.value === '__other_option__') {
                otherInput.classList.remove('hidden');
                otherInput.focus();
            } else {
                otherInput.classList.add('hidden');
            }
        }

        function getLabelMap() {
            const labelMap = new Map();
            document.getElementById('inspectionForm').querySelectorAll('.form-group').forEach(group => {
                const label = group.querySelector('.form-label');
                if(label){
                    const labelText = label.textContent.split('/')[0].trim().replace(/\s*\(.*\)\s*/g, '');
                    group.querySelectorAll('input, textarea, select').forEach(input => {
                        if(input.name) labelMap.set(input.name, labelText);
                    });
                }
            });
            return labelMap;
        }

        function checkForSavedData() {
            const savedData = localStorage.getItem('firePumpInspectionData');
            if (savedData) {
                if (confirm('พบข้อมูลที่บันทึกไว้จากการส่งครั้งล่าสุด คุณต้องการกรอกข้อมูลนั้นลงในฟอร์มหรือไม่?')) {
                    const data = JSON.parse(savedData);
                    const form = document.getElementById('inspectionForm');
                    for (const key in data) {
                        const element = form.elements[key];
                        if (element) {
                            if (element.type === 'radio') {
                                const radioToSelect = document.querySelector(`input[name="${key}"][value="${data[key]}"]`);
                                if(radioToSelect) {
                                    radioToSelect.checked = true;
                                    const radioItem = radioToSelect.closest('.radio-item, .radio-item-other');
                                    if(radioItem && data[key] === '__other_option__') {
                                        const otherInputId = radioItem.dataset.otherTarget;
                                        if (otherInputId) {
                                            const otherInput = document.getElementById(otherInputId);
                                            otherInput.classList.remove('hidden');
                                        }
                                    }
                                }
                            } else if (element.tagName === 'SELECT') {
                                element.value = data[key];
                                if(key === 'entry.1231391232' && data[key] === '__other_option__') {
                                     handleOperatorChange(element);
                                }
                            } else {
                                element.value = data[key];
                            }
                        }
                    }
                }
            }
        }
        
        function saveFormDataToLocalStorage() {
            const form = document.getElementById('inspectionForm');
            const formData = new FormData(form);
            const data = Object.fromEntries(formData.entries());
            localStorage.setItem('firePumpInspectionData', JSON.stringify(data));
        }
        
        function resetForm(force = false) {
            if (force || confirm('คุณต้องการล้างข้อมูลในฟอร์มทั้งหมดใช่หรือไม่?')) {
                document.getElementById('inspectionForm').reset();
                document.querySelectorAll('.other-input').forEach(input => input.classList.add('hidden'));
                document.getElementById('operatorOther').classList.add('hidden');
            }
        }

        function previewAnswers() {
            const dialog = document.getElementById('previewDialog');
            let contentHTML = '';
            const form = document.getElementById('inspectionForm');
            const formData = new FormData(form);
            let count = 0;
            const labelMap = getLabelMap();

            contentHTML += '<ul class="list-none space-y-3">';
            for (const [name, value] of formData.entries()) {
                if (value && value !== '__other_option__') {
                    let labelText = labelMap.get(name) || name;
                    if (name.includes('.other_option_response')) {
                         const baseName = name.replace('.other_option_response', '');
                         labelText = (labelMap.get(baseName) || baseName) + " (อื่นๆ)";
                    }
                    contentHTML += `<li class="border-b pb-2"><strong class="text-indigo-600">${labelText}:</strong><br><span class="pl-2">${value}</span></li>`;
                    count++;
                }
            }
            contentHTML += '</ul>';

            if (count === 0) {
                contentHTML = '<p class="text-center text-gray-500">ยังไม่มีการกรอกข้อมูล</p>';
            }

            dialog.innerHTML = `<div class="p-6">
                <div class="flex justify-between items-center border-b pb-3 mb-4">
                    <h2 class="text-2xl font-bold header-gradient-text">พรีวิวคำตอบ</h2>
                    <button onclick="this.closest('dialog').close()" class="text-2xl font-bold text-gray-500 hover:text-gray-800">&times;</button>
                </div>
                <div id="previewContent" class="space-y-2 text-gray-700 max-h-[70vh] overflow-y-auto">${contentHTML}</div>
            </div>`;
            dialog.showModal();
        }
        
        function exportReport() {
            const form = document.getElementById('inspectionForm');
            const formData = new FormData(form);
            const labelMap = getLabelMap();
            let reportContent = "รายงานการตรวจสอบเครื่องยนต์สูบน้ำดับเพลิง\n";
            reportContent += "========================================\n\n";
            
            reportContent += "ข้อมูลที่กรอก:\n----------------\n";
            for (const [name, value] of formData.entries()) {
                if (value && value !== '__other_option__') {
                    let labelText = labelMap.get(name) || name;
                    if (name.includes('.other_option_response')) {
                         const baseName = name.replace('.other_option_response', '');
                         labelText = (labelMap.get(baseName) || baseName) + " (อื่นๆ)";
                    }
                    reportContent += `${labelText}: ${value}\n`;
                }
            }
            
            if(lastAiAnalysisResult) {
                reportContent += "\n\nผลการวิเคราะห์จาก AI:\n-----------------------\n";
                const tempDiv = document.createElement('div');
                tempDiv.innerHTML = lastAiAnalysisResult;
                reportContent += tempDiv.innerText.replace(/(\r\n|\n|\r)/gm, "\n");
            } else {
                 reportContent += "\n\nยังไม่มีการวิเคราะห์ด้วย AI\n";
            }
            
            const blob = new Blob([reportContent], { type: 'text/plain;charset=utf-8' });
            const link = document.createElement('a');
            const date = new Date().toISOString().slice(0, 10);
            link.href = URL.createObjectURL(blob);
            link.download = `FirePump-Report-${date}.txt`;
            link.click();
            URL.revokeObjectURL(link.href);
        }

        function analyzeWithAI() {
            const dialog = document.getElementById('aiDialog');
            
            dialog.innerHTML = `<div class="p-6">
                <div class="dialog-header-ai">
                    <div class="dialog-header-content">
                        <svg class="ai-avatar" viewBox="0 0 200 200" fill="none" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="AI Avatar">
                            <defs>
                                <linearGradient id="avatar-bg-gradient" x1="0" y1="0" x2="200" y2="200" gradientUnits="userSpaceOnUse">
                                <stop stop-color="#007AFF"/>
                                <stop offset="1" stop-color="#5856D6"/>
                                </linearGradient>
                                <linearGradient id="face-plate-gradient" x1="100" y1="20" x2="100" y2="180" gradientUnits="userSpaceOnUse">
                                <stop stop-color="#F2F2F7"/>
                                <stop offset="1" stop-color="#E5E5EA"/>
                                </linearGradient>
                            </defs>
                            <circle cx="100" cy="100" r="100" fill="url(#avatar-bg-gradient)"/>
                            <g transform="translate(0, 10)">
                                <path d="M85,150 L80,170 L120,170 L115,150 Z" fill="#4B5563"/>
                                <path d="M80,140 C80,155 120,155 120,140 L125,130 L75,130 Z" fill="#6B7280"/>
                                <path d="M60,135 L50,80 Q50,30 100,30 Q150,30 150,80 L140,135 Z" fill="url(#face-plate-gradient)" stroke="#4B5563" stroke-width="3"/>
                                <path d="M70 75 L80 65 L100 65 L105 75 L100 85 L80 85 Z" fill="#007AFF" stroke="white" stroke-width="2"/>
                                <path d="M130 75 L120 65 L100 65 L95 75 L100 85 L120 85 Z" fill="#007AFF" stroke="white" stroke-width="2" transform="matrix(-1, 0, 0, 1, 200, 0)"/>
                                <path d="M90,50 L110,50 M100,50 L100,40 M95,45 L105,45" stroke="#007AFF" stroke-width="2.5" stroke-linecap="round"/>
                                <path d="M80,100 L120,100 L115,125 L85,125 Z" fill="#9CA3AF" stroke="#4B5563" stroke-width="2"/>
                                <line x1="85" y1="112" x2="115" y2="112" stroke="#6B7280" stroke-width="2"/>
                            </g>
                        </svg>
                        <h2 class="header-gradient-text">ผลการวิเคราะห์จาก AI</h2>
                    </div>
                    <button onclick="this.closest('dialog').close()" class="text-2xl font-bold text-gray-500 hover:text-gray-800">&times;</button>
                </div>
                <div id="aiLoading" class="text-center py-8">
                    <div class="spinner mx-auto" style="width:40px; height:40px; border-width:4px;"></div>
                    <p class="text-gray-500 mt-4">กำลังประมวลผลข้อมูล... กรุณารอสักครู่ 🚀</p>
                </div>
                <div id="aiResult" class="hidden space-y-4 max-h-[70vh] overflow-y-auto p-1"></div>
            </div>`;

            const loadingDiv = document.getElementById('aiLoading');
            const resultDiv = document.getElementById('aiResult');
            
            loadingDiv.style.display = 'block';
            resultDiv.classList.add('hidden');
            dialog.showModal();

            const form = document.getElementById('inspectionForm');
            const formData = new FormData(form);
            const data = Object.fromEntries(formData.entries());

            setTimeout(() => {
                const analysisHTML = generateAiAnalysis(data);
                lastAiAnalysisResult = analysisHTML;
                resultDiv.innerHTML = analysisHTML;
                loadingDiv.style.display = 'none';
                resultDiv.classList.remove('hidden');
            }, 1500);
        }
        
        const analysisRules = {
            // Liquid Levels
            'entry.1618028324': { label: 'ระดับน้ำมันหล่อลื่น', type: 'equals', std: 'ต่ำ', severity: 'critical', 
                message: `<strong>วินิจฉัย:</strong> ระดับน้ำมันหล่อลื่นต่ำกว่าเกณฑ์ปกติอย่างมีนัยสำคัญ
                          <span class="engineering-note"><strong>ผลกระทบ:</strong> เสี่ยงต่อการสึกหรอของชิ้นส่วนภายในเครื่องยนต์อย่างรุนแรง (เช่น ลูกสูบ, แบริ่ง) อาจทำให้เครื่องยนต์น็อคและเสียหายถาวรได้</span>
                          <span class="engineering-note"><strong>คำแนะนำ:</strong> เติมน้ำมันหล่อลื่นเกรดที่ถูกต้องตามสเปคผู้ผลิตให้อยู่ในระดับ Full ทันที และตรวจสอบหารอยรั่วซึม</span>` 
            },
            'entry.14334317': { label: 'ระดับน้ำระบายความร้อน', type: 'equals', std: 'ต่ำ', severity: 'critical',
                message: `<strong>วินิจฉัย:</strong> ระดับน้ำในระบบหล่อเย็นต่ำกว่าระดับที่กำหนด
                          <span class="engineering-note"><strong>ผลกระทบ:</strong> ประสิทธิภาพการระบายความร้อนลดลง ทำให้เครื่องยนต์เกิดภาวะ Overheat ซึ่งอาจนำไปสู่การเสียหายของปะเก็นฝาสูบหรือฝาสูบโก่งได้</span>
                          <span class="engineering-note"><strong>คำแนะนำ:</strong> เติมน้ำยาหล่อเย็น (Coolant) ให้ได้ระดับ และตรวจสอบการรั่วซึมในระบบ เช่น ท่อยาง, หม้อน้ำ, และปั๊มน้ำ</span>`
            },
            'entry.1091386807': { label: 'ระดับน้ำกลั่นของแบตเตอรี่', type: 'equals', std: 'ต่ำ', severity: 'critical',
                message: `<strong>วินิจฉัย:</strong> ระดับน้ำกลั่นในแบตเตอรี่ต่ำกว่าระดับ Lower
                          <span class="engineering-note"><strong>ผลกระทบ:</strong> แผ่นธาตุภายในแบตเตอรี่จะสัมผัสกับอากาศ เกิดปฏิกิริยาซัลเฟตเกาะที่แผ่นธาตุ ทำให้ความสามารถในการเก็บประจุลดลงอย่างถาวร และแบตเตอรี่เสื่อมสภาพก่อนเวลาอันควร</span>
                          <span class="engineering-note"><strong>คำแนะนำ:</strong> เติมน้ำกลั่นบริสุทธิ์ (เท่านั้น) ให้อยู่ในระดับ Upper และตรวจสอบระบบการชาร์จว่ามีแรงดันสูงเกินไป (Overcharging) หรือไม่ ซึ่งเป็นสาเหตุให้น้ำกลั่นระเหยเร็ว</span>`
            },
             'entry.964120987': { label: 'Fuel Tank Level', type: 'less_than', std: 50, severity: 'warning',
                message: (val) => `<strong>วินิจฉัย:</strong> ระดับน้ำมันเชื้อเพลิง (เหลือ ${val} ลิตร) ค่อนข้างน้อย
                                     <span class="engineering-note"><strong>ผลกระทบ:</strong> อาจไม่เพียงพอต่อการทำงานต่อเนื่องเป็นเวลานานในสถานการณ์ฉุกเฉิน และการปล่อยให้ระดับน้ำมันต่ำอาจทำให้ตะกอนที่ก้นถังถูกดูดเข้าไปในระบบ</span>
                                     <span class="engineering-note"><strong>คำแนะนำ:</strong> ควรรักษาะดับน้ำมันเชื้อเพลิงให้มากกว่า 75% ของความจุถังเสมอเพื่อความพร้อมใช้งานสูงสุด</span>`
            },
            // Leak Inspection
            'entry.323305993': { label: 'การรั่วไหลของน้ำมันเชื้อเพลิง', type: 'equals', std: 'รั่วไหล', severity: 'critical',
                message: `<strong>วินิจฉัย:</strong> ตรวจพบการรั่วซึมในระบบส่งจ่ายน้ำมันเชื้อเพลิง
                          <span class="engineering-note"><strong>ผลกระทบ:</strong> เป็นอันตรายร้ายแรง! เสี่ยงต่อการเกิดอัคคีภัยได้ง่ายเมื่อมีประกายไฟหรือความร้อนสูง และทำให้สิ้นเปลืองเชื้อเพลิงโดยใช่เหตุ</span>
                          <span class="engineering-note"><strong>คำแนะนำ:</strong> หยุดใช้งานเครื่องยนต์ทันที! ตรวจสอบหาจุดรั่วตามท่อทาง, ข้อต่อ, และปั๊มเชื้อเพลิง และดำเนินการซ่อมแซมโดยผู้เชี่ยวชาญ</span>`
            },
            'entry.1072480311': { label: 'การรั่วไหลของน้ำมันหล่อลื่น', type: 'equals', std: 'รั่วไหล', severity: 'critical',
                message: `<strong>วินิจฉัย:</strong> ตรวจพบการรั่วซึมของน้ำมันหล่อลื่น
                          <span class="engineering-note"><strong>ผลกระทบ:</strong> ทำให้ระดับน้ำมันหล่อลื่นลดลงอย่างรวดเร็ว ส่งผลให้การหล่อลื่นไม่เพียงพอและเครื่องยนต์อาจเสียหายรุนแรง</span>
                          <span class="engineering-note"><strong>คำแนะนำ:</strong> ตรวจสอบหาจุดรั่วซึม เช่น ปะเก็นอ่างน้ำมันเครื่อง, ซีลข้อเหวี่ยง และทำการซ่อมแซมโดยด่วน</span>`
            },
            'entry.1607591057': { label: 'การรั่วไหลของน้ำระบายความร้อน', type: 'equals', std: 'รั่วไหล', severity: 'critical',
                message: `<strong>วินิจฉัย:</strong> ตรวจพบการรั่วซึมในระบบระบายความร้อน
                          <span class="engineering-note"><strong>ผลกระทบ:</strong> ทำให้ระดับน้ำหล่อเย็นลดลงและเกิดภาวะ Overheat ได้ง่าย</span>
                          <span class="engineering-note"><strong>คำแนะนำ:</strong> ตรวจสอบท่อยาง, หม้อน้ำ, ปั๊มน้ำ และจุดเชื่อมต่อต่างๆ เพื่อหาและแก้ไขรอยรั่ว</span>`
            },
            // Mechanical Parts
            'entry.719816448': { label: 'ตรวจเช็คสภาพของสลักและน๊อต', type: 'equals', std: 'น็อตไม่แน่น', severity: 'warning',
                message: `<strong>วินิจฉัย:</strong> พบสลักเกลียวหรือน็อตมีอาการคลายตัว
                          <span class="engineering-note"><strong>ผลกระทบ:</strong> แรงสั่นสะเทือนจากการทำงานของเครื่องยนต์อาจทำให้น็อตคลายตัวมากขึ้น ส่งผลให้ชิ้นส่วนยึดไม่แน่น เกิดเสียงดัง หรืออาจหลุดจนเกิดความเสียหายได้</span>
                          <span class="engineering-note"><strong>คำแนะนำ:</strong> ควรทำการขันน็อตให้แน่นตามค่าแรงบิด (Torque) ที่กำหนด และตรวจสอบจุดอื่นๆ ที่อาจคลายตัวได้ เช่น แท่นเครื่อง, ท่อไอเสีย</span>`
            },
            'entry.737194412': { label: 'ตรวจเช็คสภาพของขั้วต่อสายไฟฟ้า', type: 'equals', std: 'ขั้วสายไม่แน่น', severity: 'critical',
                message: `<strong>วินิจฉัย:</strong> ขั้วต่อสายไฟฟ้าหลัก (เช่น ขั้วแบตเตอรี่, ไดชาร์จ, ไดสตาร์ท) ไม่แน่น
                          <span class="engineering-note"><strong>ผลกระทบ:</strong> การเชื่อมต่อที่ไม่สมบูรณ์ทำให้เกิดความต้านทานสูง ณ จุดเชื่อมต่อ เกิดความร้อนสะสมสูงมากจนอาจละลายฉนวนและเป็นสาเหตุของเพลิงไหม้ได้ อีกทั้งยังทำให้การชาร์จไฟหรือการสตาร์ทเครื่องยนต์มีปัญหา</span>
                          <span class="engineering-note"><strong>คำแนะนำ:</strong> ทำความสะอาดขั้วสายและขันให้แน่นทันที</span>`
            },
            'entry.1182164809': { label: 'ตรวจเช็คไส้กรองอากาศ', type: 'equals', std: 'ไส้กรองตัน', severity: 'warning',
                message: `<strong>วินิจฉัย:</strong> ไส้กรองอากาศมีการอุดตัน
                          <span class="engineering-note"><strong>ผลกระทบ:</strong> อากาศเข้าสู่ห้องเผาไหม้ได้น้อยลง ทำให้ส่วนผสมน้ำมันหนาเกินไป การเผาไหม้ไม่สมบูรณ์ เกิดควันดำ สิ้นเปลืองเชื้อเพลิง และกำลังเครื่องยนต์ตก</span>
                          <span class="engineering-note"><strong>คำแนะนำ:</strong> เป่าทำความสะอาดหรือเปลี่ยนไส้กรองอากาศใหม่ตามความเหมาะสม</span>`
            },
            'entry.950885152': { label: 'ตรวจเช็คไส้กรองน้ำมัน', type: 'equals', std: 'ตัน', severity: 'warning',
                message: `<strong>วินิจฉัย:</strong> ไส้กรองน้ำมันเชื้อเพลิง (ดีเซล) อุดตัน
                          <span class="engineering-note"><strong>ผลกระทบ:</strong> เชื้อเพลิงไหลไปเลี้ยงปั๊มได้ไม่สะดวก ทำให้แรงดันตก เครื่องยนต์อาจเร่งไม่ขึ้น, กำลังตก, หรือดับกลางคันได้</span>
                          <span class="engineering-note"><strong>คำแนะนำ:</strong> ควรเปลี่ยนไส้กรองน้ำมันเชื้อเพลิงตามระยะที่กำหนด หรือเปลี่ยนทันทีเมื่อพบการอุดตัน</span>`
            },
            // Pump System
            'entry.824942619': { label: 'เช็คน้ำในท่อดูดปั๊มน้ำ', type: 'equals', std: 'มีรอยรั่ว', severity: 'critical',
                message: `<strong>วินิจฉัย:</strong> ท่อทางดูด (Suction Pipe) ของปั๊มน้ำมีรอยรั่ว
                          <span class="engineering-note"><strong>ผลกระทบ:</strong> ปั๊มจะดูดอากาศเข้าไปในระบบแทนที่จะเป็นน้ำ (เกิด Cavitation) ทำให้ปั๊มไม่สามารถสร้างแรงดันได้ หรือแรงดันตกวูบวาบ ซึ่งเป็นอันตรายอย่างยิ่งต่อประสิทธิภาพการดับเพลิง</span>
                          <span class="engineering-note"><strong>คำแนะนำ:</strong> หาจุดรั่วและทำการซ่อมแซมโดยด่วน อาจต้องตรวจสอบซีลและปะเก็นบริเวณหน้าแปลนของปั๊มด้วย</span>`
            },
            'entry.1298699451': { label: 'ทดสอบการทำงานของปั๊มรักษาแรงดัน', type: 'equals', std: 'ผิดปกติ', severity: 'critical',
                message: `<strong>วินิจฉัย:</strong> Jocky Pump (ปั๊มรักษาแรงดัน) ทำงานผิดปกติ
                          <span class="engineering-note"><strong>ผลกระทบ:</strong> หาก Jocky Pump ไม่ทำงานเพื่อชดเชยแรงดันรั่วซึมเล็กน้อยในระบบ จะทำให้ Fire Pump ต้องทำงานบ่อยโดยไม่จำเป็น ส่งผลให้เกิดการสึกหรอและอาจทำให้ผู้ดูแลไม่ทราบถึงการรั่วซึมเล็กๆ ในระบบ</span>
                          <span class="engineering-note"><strong>คำแนะนำ:</strong> ตรวจสอบระบบควบคุม, Pressure Switch, และตัวปั๊มของ Jocky Pump โดยละเอียด</span>`
            },
            'entry.170318696': { label: 'แรงดันน้ำที่ปั๊มเริ่มทำงาน', type: 'numeric_range', std: [95, 105], severity: 'critical',
                low_message: (val, std) => `<strong>วินิจฉัย:</strong> Jockey Pump เริ่มทำงานที่แรงดัน ${val} PSI ซึ่งอาจต่ำเกินไป
                                     <span class="engineering-note"><strong>ผลกระทบทางวิศวกรรม:</strong> หากตั้งค่า Start Pressure ต่ำเกินไป (ใกล้เคียงกับแรงดันเริ่มของ Fire Pump) อาจทำให้ Fire Pump เริ่มทำงานก่อน ซึ่งไม่ถูกต้องตามหลักการ</span>
                                     <span class="engineering-note"><strong>คำแนะนำ:</strong> ตรวจสอบและปรับตั้ง Pressure Switch ของ Jockey Pump ให้เริ่มทำงานที่ 100 PSI</span>`,
                high_message: (val, std) => `<strong>วินิจฉัย:</strong> Jockey Pump เริ่มทำงานที่แรงดัน ${val} PSI ซึ่งสูงเกินไป
                                     <span class="engineering-note"><strong>ผลกระทบทางวิศวกรรม:</strong> การตั้งค่าแรงดันเริ่มทำงานสูงไป จะทำให้ปั๊มทำงานบ่อยเกินความจำเป็นและอาจทำงานตลอดเวลาหากมีรอยรั่วซึมเล็กน้อย</span>
                                     <span class="engineering-note"><strong>คำแนะนำ:</strong> ตรวจสอบและปรับตั้ง Pressure Switch ของ Jockey Pump ให้เริ่มทำงานที่ 100 PSI</span>`
            },
             'entry.835390568': { label: 'แรงดันน้ำที่ปั๊มหยุดทำงาน', type: 'numeric_range', std: [120, 130], severity: 'critical',
                low_message: (val, std) => `<strong>วินิจฉัย:</strong> Jockey Pump หยุดทำงานที่แรงดัน ${val} PSI ซึ่งต่ำกว่ามาตรฐาน (${std[0]}-${std[1]} PSI)
                                     <span class="engineering-note"><strong>ผลกระทบทางวิศวกรรม:</strong> แรงดันในเส้นท่อจะไม่อยู่ในระดับที่พร้อมใช้งานสูงสุดตลอดเวลา</span>
                                     <span class="engineering-note"><strong>คำแนะนำ:</strong> ปรับตั้ง Pressure Switch ของ Jockey Pump ให้หยุดทำงานในช่วง 120-130 PSI</span>`,
                high_message: (val, std) => `<strong>วินิจฉัย:</strong> Jockey Pump หยุดทำงานที่แรงดัน ${val} PSI ซึ่งสูงกว่ามาตรฐาน (${std[0]}-${std[1]} PSI)
                                     <span class="engineering-note"><strong>ผลกระทบทางวิศวกรรม:</strong> สร้างแรงดันในระบบสูงเกินความจำเป็นโดยใช่เหตุ อาจเป็นอันตรายต่ออุปกรณ์บางชิ้นในระยะยาว</span>
                                     <span class="engineering-note"><strong>คำแนะนำ:</strong> ปรับตั้ง Pressure Switch ของ Jockey Pump ให้หยุดทำงานในช่วง 120-130 PSI</span>`
            },
            // Engine Performance
            'entry.380068157': { label: 'V Belts Condition', type: 'equals', std: 'สายพานหย่อน', severity: 'warning',
                message: `<strong>วินิจฉัย:</strong> สายพานมีอาการหย่อน
                          <span class="engineering-note"><strong>ผลกระทบ:</strong> อาจทำให้เกิดเสียงดัง, ประสิทธิภาพการชาร์จไฟจากไดชาร์จลดลง และการระบายความร้อนจากปั๊มน้ำไม่มีประสิทธิภาพเท่าที่ควร เสี่ยงที่สายพานจะหลุดออกจากร่องพูลเลย์</span>
                          <span class="engineering-note"><strong>คำแนะนำ:</strong> ทำการปรับตั้งความตึงของสายพานให้ได้ตามมาตรฐาน (โดยทั่วไปกดแล้วยุบได้ไม่เกิน 1-1.5 ซม.) หากสายพานมีรอยแตกควรรีบเปลี่ยนใหม่</span>`
            },
            'entry.1506477567': { label: 'แรงดันน้ำขณะเครื่องยนต์ทำงาน', type: 'numeric_range', std: [115, 130], severity: 'warning',
                low_message: (val, std) => `<strong>วินิจฉัย:</strong> ขณะเครื่องยนต์ทำงาน แรงดันน้ำอยู่ที่ ${val} PSI ซึ่งต่ำกว่าที่ควรจะเป็น (${std[0]}-${std[1]} PSI)
                                     <span class="engineering-note"><strong>ผลกระทบทางวิศวกรรม:</strong> ประสิทธิภาพในการส่งน้ำดับเพลิงอาจไม่เพียงพอ โดยเฉพาะกับอาคารสูงหรือจุดที่อยู่ไกลจากปั๊ม</span>
                                     <span class="engineering-note"><strong>คำแนะนำ:</strong> ตรวจสอบรอบเครื่องยนต์ว่าต่ำไปหรือไม่ หรืออาจมีปัญหารั่วในระบบ หรือปั๊มอาจสึกหรอ</span>`,
                high_message: (val, std) => `<strong>วินิจฉัย:</strong> ขณะเครื่องยนต์ทำงาน แรงดันน้ำอยู่ที่ ${val} PSI ซึ่งสูงกว่าที่ควรจะเป็น (${std[0]}-${std[1]} PSI)
                                     <span class="engineering-note"><strong>ผลกระทบทางวิศวกรรม:</strong> แรงดันที่สูงเกินไปอาจเป็นอันตรายต่อท่อ, ข้อต่อ, และวาล์วในระบบ</span>
                                     <span class="engineering-note"><strong>คำแนะนำ:</strong> ตรวจสอบรอบเครื่องยนต์ว่าสูงเกินไปหรือไม่ หรือ Pressure Relief Valve อาจทำงานผิดปกติ</span>`
            },
            // System Status
            'entry.1316882575': { label: 'การทำงานของไฟแสดงผล', type: 'equals', std: 'ไฟติดไม่ครบ', severity: 'warning',
                message: `<strong>วินิจฉัย:</strong> ไฟแสดงสถานะบนแผงควบคุมติดไม่ครบ
                          <span class="engineering-note"><strong>ผลกระทบ:</strong> ผู้ปฏิบัติงานอาจไม่สามารถรับทราบสถานะที่แท้จริงของระบบได้ เช่น ไม่ทราบเมื่อเกิดเหตุขัดข้อง (Fault) หรือเมื่อระบบกำลังทำงาน</span>
                          <span class="engineering-note"><strong>คำแนะนำ:</strong> ตรวจสอบหลอดไฟและวงจรที่เกี่ยวข้องเพื่อทำการซ่อมแซม</span>`
            },
            'entry.628997006': { label: 'ตรวจเช็คการสั่นของเครื่องยนต์', type: 'equals', std: 'ผิดปกติ(เครื่องสั่นมาก)', severity: 'critical',
                message: `<strong>วินิจฉัย:</strong> เครื่องยนต์มีอาการสั่นสะเทือนรุนแรงผิดปกติขณะทำงาน
                          <span class="engineering-note"><strong>ผลกระทบ:</strong> อาจเป็นสัญญาณของปัญหาที่รุนแรง เช่น การจุดระเบิดไม่ครบสูบ, ยางแท่นเครื่องขาด, หรือความไม่สมดุลของชิ้นส่วนภายใน การปล่อยทิ้งไว้อาจทำให้เกิดความเสียหายรุนแรงตามมา</span>
                          <span class="engineering-note"><strong>คำแนะนำ:</strong> ควรหยุดเครื่องและให้ช่างผู้ชำนาญตรวจสอบหาสาเหตุโดยละเอียด</span>`
            },
            'entry.1209254361': { label: 'ตรวจเช็คความผิดปกติของเสียง', type: 'equals', std: 'มีเสียงผิดปกติ', severity: 'critical',
                message: `<strong>วินิจฉัย:</strong> มีเสียงดังผิดปกติเกิดขึ้นขณะเครื่องยนต์ทำงาน
                          <span class="engineering-note"><strong>ผลกระทบ:</strong> เสียงที่ผิดปกติมักเป็นสัญญาณเตือนของความเสียหายที่กำลังจะเกิดขึ้น เช่น เสียงโลหะกระทบกันอาจหมายถึงชิ้นส่วนภายในหลวมหรือแตกหัก</span>
                          <span class="engineering-note"><strong>คำแนะนำ:</strong> ระบุแหล่งที่มาของเสียงและทำการตรวจสอบโดยละเอียด อาจต้องหยุดการทำงานของเครื่องเพื่อความปลอดภัย</span>`
            },
            'entry.950605992': { label: 'การทำงานของสวิทช์', type: 'equals', std: 'ทำงานผิดปกติ', severity: 'critical',
                message: `<strong>วินิจฉัย:</strong> Flow Switch ทำงานผิดปกติ
                          <span class="engineering-note"><strong>ผลกระทบ:</strong> Flow Switch มีหน้าที่ตรวจจับการไหลของน้ำในท่อเพื่อส่งสัญญาณไปที่ตู้ควบคุม หากทำงานผิดพลาดอาจทำให้ระบบไม่ส่งสัญญาณเตือนเมื่อมีการใช้น้ำดับเพลิงจริง</span>
                          <span class="engineering-note"><strong>คำแนะนำ:</strong> ตรวจสอบการทำงานของ Flow Switch และวงจรที่เกี่ยวข้อง</span>`
            },
             // Maintenance
            'entry.764561274': { label: 'V Belts Condition/ตรวจเช็คการทำงานของสายพาน', type: 'equals', std: 'ฉีกขาด', severity: 'critical',
                message: `<strong>วินิจฉัย:</strong> สายพานมีร่องรอยการฉีกขาด
                          <span class="engineering-note"><strong>ผลกระทบ:</strong> มีความเสี่ยงสูงมากที่สายพานจะขาดขณะเครื่องยนต์ทำงาน ซึ่งจะทำให้อุปกรณ์ที่เกี่ยวข้องทั้งหมดหยุดทำงานทันที เช่น ปั๊มน้ำ, ไดชาร์จ ส่งผลให้เครื่อง Overheat และไม่สามารถทำงานต่อได้</span>
                          <span class="engineering-note"><strong>คำแนะนำ:</strong> เปลี่ยนสายพานเส้นใหม่ทันที ห้ามใช้งานต่อ</span>`
            },
            'entry.1833812342': { label: 'แรงดันการชาร์จแบตเตอรี่', type: 'less_than', std: 13.0, severity: 'warning',
                message: (val) => `<strong>วินิจฉัย:</strong> แรงดันการชาร์จแบตเตอรี่ (วัดได้ ${val} V) ต่ำกว่าที่ควรจะเป็น
                                     <span class="engineering-note"><strong>ผลกระทบทางวิศวกรรม:</strong> ระบบชาร์จไฟ (ไดชาร์จ) อาจทำงานได้ไม่เต็มประสิทธิภาพ ทำให้แบตเตอรี่ไม่ได้รับการชาร์จไฟกลับเต็มที่หลังจากการสตาร์ท อาจส่งผลให้แบตเตอรี่มีไฟไม่พอในระยะยาว</span>
                                     <span class="engineering-note"><strong>คำแนะนำ:</strong> ตรวจสอบไดชาร์จและระบบควบคุมแรงดัน (Voltage Regulator) ปกติควรมีแรงดันชาร์จอยู่ที่ประมาณ 13.5-14.5V ขณะเครื่องยนต์ทำงาน</span>`
            },
            'entry.1502505224': { label: 'Test Battery/ทดสอบแบตเตอรี่', type: 'less_than', std: 12.2, severity: 'critical', 
                message: (val) => `<strong>วินิจฉัย:</strong> แรงดันไฟฟ้าของแบตเตอรี่ (วัดได้ ${val} VDC) ต่ำกว่าค่ามาตรฐาน
                                     <span class="engineering-note"><strong>ผลกระทบ:</strong> กำลังในการสตาร์ทเครื่องยนต์ไม่เพียงพอ มีความเสี่ยงสูงที่จะไม่สามารถสตาร์ทเครื่องยนต์ได้ในสถานการณ์ฉุกเฉิน</span>
                                     <span class="engineering-note"><strong>คำแนะนำ:</strong> ควรพิจารณาเปลี่ยนแบตเตอรี่ลูกใหม่ที่มีค่า CCA (Cold Cranking Amps) ตรงตามสเปคของเครื่องยนต์โดยด่วน</span>`
            },
            // Electrical System
             'entry.1952860784': { label: 'ตรวจสอบความผิดปกติของเสียงและกลิ่น', type: 'equals', std: 'ผิดปกติ', severity: 'critical',
                message: `<strong>วินิจฉัย:</strong> ตรวจพบเสียงหรือกลิ่นผิดปกติในระบบไฟฟ้า
                          <span class="engineering-note"><strong>ผลกระทบ:</strong> กลิ่นไหม้หรือเสียงอาร์คเป็นสัญญาณอันตรายของการลัดวงจรหรืออุปกรณ์ไฟฟ้าทำงานหนักเกินไป ซึ่งอาจนำไปสู่การเกิดเพลิงไหม้ได้</span>
                          <span class="engineering-note"><strong>คำแนะนำ:</strong> รีบตัดระบบไฟฟ้าและตรวจสอบหาต้นตอของปัญหาโดยผู้เชี่ยวชาญทันที</span>`
            },
            'entry.1304076428': { label: 'ตรวจเช็คสภาพของ Indicator', type: 'equals', std: 'ผิดปกติ', severity: 'warning',
                message: `<strong>วินิจฉัย:</strong> Indicator หรือไฟแสดงสถานะของ Circuit Breaker ทำงานผิดปกติ
                          <span class="engineering-note"><strong>ผลกระทบ:</strong> ทำให้ไม่สามารถทราบสถานะที่แท้จริงของเบรกเกอร์ได้ (ON/OFF/TRIP)</span>
                          <span class="engineering-note"><strong>คำแนะนำ:</strong> ตรวจสอบและซ่อมแซมกลไกหรือหลอดไฟของ Indicator</span>`
            },
            'entry.1601277291': { label: 'ตรวจสอบสภาพและการทำงานทั่วไป', type: 'equals', std: 'ผิดปกติ', severity: 'warning',
                message: `<strong>วินิจฉัย:</strong> การทำงานทั่วไปของระบบไฟฟ้าผิดปกติ
                          <span class="engineering-note"><strong>ผลกระทบ:</strong> บ่งชี้ถึงปัญหาที่อาจยังไม่แสดงอาการรุนแรง แต่ควรได้รับการตรวจสอบ</span>
                          <span class="engineering-note"><strong>คำแนะนำ:</strong> ควรระบุรายละเอียดของความผิดปกติและดำเนินการตรวจสอบ</span>`
            },
             'entry.851234898': { label: 'ตรวจสอบสภาพโครงสร้างของอุปกรณ์', type: 'equals', std: 'ผิดปกติ', severity: 'warning',
                message: `<strong>วินิจฉัย:</strong> โครงสร้างตู้ควบคุมหรืออุปกรณ์ไฟฟ้ามีสภาพผิดปกติ เช่น ขึ้นสนิม, บิดเบี้ยว, มีรอยแตก
                          <span class="engineering-note"><strong>ผลกระทบ:</strong> อาจส่งผลต่อความแข็งแรงและความปลอดภัยในการป้องกันอุปกรณ์ภายใน</span>
                          <span class="engineering-note"><strong>คำแนะนำ:</strong> ดำเนินการซ่อมแซมเพื่อรักษาสภาพของโครงสร้างให้สมบูรณ์</span>`
            },
            'entry.1956843408': { label: 'ตรวจสอบฉนวนและกราวด์', type: 'equals', std: 'เสื่อมสภาพ', severity: 'critical',
                message: `<strong>วินิจฉัย:</strong> ฉนวนสายไฟหรือระบบกราวด์เสื่อมสภาพ
                          <span class="engineering-note"><strong>ผลกระทบ:</strong> ฉนวนที่เสื่อมสภาพอาจทำให้เกิดไฟรั่วหรือลัดวงจรได้ ส่วนระบบกราวด์ที่ไม่ดีจะไม่สามารถป้องกันอันตรายจากไฟดูดได้เมื่อเกิดเหตุไฟรั่ว</span>
                          <span class="engineering-note"><strong>คำแนะนำ:</strong> ตรวจวัดค่าความต้านทานฉนวนและค่าความต้านทานหลักดิน หากไม่ได้มาตรฐานต้องรีบดำเนินการแก้ไข</span>`
            },
            'entry.1745325661': { label: 'ตรวจขันน๊อตล็อกขั้วสายไฟและจุดต่อต่างๆ', type: 'equals', std: 'ผิดปกติ', severity: 'critical',
                message: `<strong>วินิจฉัย:</strong> การยึดขั้วสายไฟและจุดต่อต่างๆ ไม่แน่น
                          <span class="engineering-note"><strong>ผลกระทบ:</strong> เหมือนกับกรณีขั้วสายไม่แน่น คือทำให้เกิดความร้อนสูง (High Resistance Contact) และเสี่ยงต่อการเกิดอัคคีภัยอย่างยิ่ง</span>
                          <span class="engineering-note"><strong>คำแนะนำ:</strong> ทำการตรวจสอบและขันจุดเชื่อมต่อทางไฟฟ้าทั้งหมดให้แน่น</span>`
            },
            // Safety and Protection
            'entry.498232465': { label: 'ตรวจสอบอุปกรณ์ระบบความปลอดภัย', type: 'equals', std: 'ไม่พร้อมใช้งาน', severity: 'critical',
                message: `<strong>วินิจฉัย:</strong> อุปกรณ์ความปลอดภัย เช่น Emergency Stop, Limit Switch, หรือเซ็นเซอร์ต่างๆ ไม่พร้อมใช้งาน
                          <span class="engineering-note"><strong>ผลกระทบ:</strong> ระบบจะไม่สามารถหยุดทำงานหรือป้องกันตัวเองได้ในสภาวะฉุกเฉิน ซึ่งอาจนำไปสู่ความเสียหายรุนแรงต่ออุปกรณ์หรือเป็นอันตรายต่อบุคคล</span>
                          <span class="engineering-note"><strong>คำแนะนำ:</strong> ซ่อมแซมอุปกรณ์ความปลอดภัยให้อยู่ในสภาพพร้อมใช้งาน 100% เสมอ</span>`
            },
            'entry.1443945119': { label: 'ตรวจสอบฟิวส์และอุปกรณ์ป้องกันต่างๆ', type: 'equals', std: 'ไม่พร้อมใช้งาน', severity: 'critical',
                message: `<strong>วินิจฉัย:</strong> ฟิวส์หรืออุปกรณ์ป้องกัน (เช่น Circuit Breaker, Overload Relay) ไม่พร้อมใช้งาน
                          <span class="engineering-note"><strong>ผลกระทบ:</strong> ระบบจะขาดการป้องกันกระแสเกินหรือการลัดวงจร หากเกิดเหตุขัดข้องอาจทำให้อุปกรณ์หลัก เช่น มอเตอร์หรือแผงวงจร ได้รับความเสียหายอย่างหนัก</span>
                          <span class="engineering-note"><strong>คำแนะนำ:</strong> ตรวจสอบและเปลี่ยนฟิวส์หรือซ่อมแซมอุปกรณ์ป้องกันให้กลับมาทำงานได้ตามปกติ</span>`
            },
            'entry.569091221': { label: 'ตรวจสอบการทำงานในระบบอาคารอัติโนมัติ', type: 'equals', std: 'ไม่พร้อมใช้งาน', severity: 'warning',
                message: `<strong>วินิจฉัย:</strong> การเชื่อมต่อหรือการสื่อสารกับระบบควบคุมอาคารอัตโนมัติ (BAS) ไม่ทำงาน
                          <span class="engineering-note"><strong>ผลกระทบ:</strong> ศูนย์ควบคุมกลางจะไม่สามารถเห็นสถานะหรือควบคุม Fire Pump ได้ ทำให้การบริหารจัดการเหตุฉุกเฉินทำได้ยากขึ้น</span>
                          <span class="engineering-note"><strong>คำแนะนำ:</strong> ตรวจสอบสายสัญญาณ, โปรโตคอลการสื่อสาร, และการตั้งค่าในระบบ BAS</span>`
            },
            'entry.209108764': { label: 'บันทึกค่าแรงดัน', type: 'less_than', std: 12.0, severity: 'critical',
                message: (val) => `<strong>วินิจฉัย:</strong> แรงดันไฟฟ้าที่บันทึกได้ (${val} V) ต่ำกว่า 12V อย่างมีนัยสำคัญ
                                     <span class="engineering-note"><strong>ผลกระทบ:</strong> เป็นสัญญาณบ่งชี้ว่าแบตเตอรี่อยู่ในสภาวะคายประจุจนเกือบหมด (Deep Discharge) หรืออาจมีเซลล์ใดเซลล์หนึ่งเสียหาย ไม่สามารถจ่ายกระแสไฟเพื่อสตาร์ทเครื่องยนต์ได้อย่างแน่นอน</span>
                                     <span class="engineering-note"><strong>คำแนะนำ:</strong> ต้องดำเนินการแก้ไขเรื่องแบตเตอรี่และระบบชาร์จโดยทันที</span>`
            },
            // Existing Rules (Checked and Confirmed)
            'entry.1127101964': { label: 'Cooling Water Temperature', type: 'numeric_range', std: [80, 100], severity: 'warning',
                low_message: (val, std) => `<strong>วินิจฉัย:</strong> อุณหภูมิน้ำหล่อเย็น (${val} °C) ต่ำกว่าช่วงทำงานปกติ (${std[0]}-${std[1]} °C)
                                     <span class="engineering-note"><strong>ผลกระทบทางวิศวกรรม:</strong> หากเครื่องทำงานมาระยะหนึ่งแล้วอุณหภูมิยังต่ำอยู่ อาจบ่งชี้ว่าเทอร์โมสตัท (วาล์วน้ำ) เปิดค้าง ทำให้เครื่องยนต์ร้อนถึงอุณหภูมิทำงานช้าเกินไป ส่งผลให้การเผาไหม้ไม่สมบูรณ์และเกิดการสึกหรอสูง</span>
                                     <span class="engineering-note"><strong>คำแนะนำ:</strong> ตรวจสอบการทำงานของเทอร์โมสตัท</span>`,
                high_message: (val, std) => `<strong>วินิจฉัย:</strong> อุณหภูมิน้ำหล่อเย็น (${val} °C) สูงกว่าช่วงทำงานปกติ (${std[0]}-${std[1]} °C)
                                     <span class="engineering-note"><strong>ผลกระทบทางวิศวกรรม:</strong> มีความเสี่ยงสูงที่เครื่องยนต์จะ Overheat ซึ่งอาจสร้างความเสียหายร้ายแรงต่อปะเก็นฝาสูบ, ฝาสูบโก่ง, หรือชิ้นส่วนภายในเครื่องยนต์เสียหาย</span>
                                     <span class="engineering-note"><strong>คำแนะนำ:</strong> ตรวจสอบการทำงานของพัดลม, ระดับน้ำ, และการอุดตันในระบบหม้อน้ำโดยด่วน</span>`
            },
            'entry.1301900075': { label: 'Lubricating Oil Pressure', type: 'numeric_range', std: [250, 750], severity: 'critical',
                low_message: (val, std) => `<strong>วินิจฉัย:</strong> แรงดันน้ำมันหล่อลื่น (${val} Kpa) ต่ำกว่ามาตรฐาน (${std[0]}-${std[1]} Kpa)
                                     <span class="engineering-note"><strong>ผลกระทบทางวิศวกรรม:</strong> เป็นสภาวะอันตรายร้ายแรง! การหล่อลื่นไม่เพียงพอจะทำให้เกิดการเสียดสีรุนแรงที่แบริ่งและเพลาข้อเหวี่ยง อาจนำไปสู่ความเสียหายถาวรของเครื่องยนต์ (Engine Seizure)</span>
                                     <span class="engineering-note"><strong>คำแนะนำ:</strong> หยุดเครื่องยนต์ทันที! ตรวจสอบระดับน้ำมันเครื่อง, การอุดตันของกรอง, หรืออาจเกิดปัญหาที่ปั๊มน้ำมันเครื่อง (Oil Pump)</span>`,
                high_message: (val, std) => `<strong>วินิจฉัย:</strong> แรงดันน้ำมันหล่อลื่น (${val} Kpa) สูงกว่ามาตรฐาน (${std[0]}-${std[1]} Kpa)
                                     <span class="engineering-note"><strong>ผลกระทบทางวิศวกรรม:</strong> อาจเกิดจากการอุดตันของไส้กรองน้ำมันเครื่อง หรือวาล์วระบายแรงดัน (Relief Valve) ทำงานผิดปกติ แรงดันที่สูงเกินไปอาจทำให้ซีลและปะเก็นต่างๆ เสียหายจนเกิดการรั่วซึมได้</span>
                                     <span class="engineering-note"><strong>คำแนะนำ:</strong> ตรวจสอบ/เปลี่ยนไส้กรองน้ำมันเครื่อง และตรวจสอบวาล์วระบายแรงดัน</span>`
            },
            'entry.1405771031': { label: 'Engine RPM', type: 'numeric_range', std: [2200, 2400], severity: 'warning',
                low_message: (val, std) => `<strong>วินิจฉัย:</strong> ความเร็วรอบเครื่องยนต์ (${val} RPM) ต่ำกว่าช่วงมาตรฐาน (${std[0]}-${std[1]} RPM)
                                     <span class="engineering-note"><strong>ผลกระทบทางวิศวกรรม:</strong> อาจทำให้ปั๊มน้ำสร้างแรงดันและอัตราการไหลได้ไม่ถึงค่าที่ออกแบบไว้ ประสิทธิภาพการดับเพลิงลดลง และไดชาร์จอาจผลิตกระแสไฟได้ไม่เพียงพอ</span>
                                     <span class="engineering-note"><strong>คำแนะนำ:</strong> ปรับจูน Governor หรือระบบควบคุมรอบเครื่องยนต์</span>`,
                high_message: (val, std) => `<strong>วินิจฉัย:</strong> ความเร็วรอบเครื่องยนต์ (${val} RPM) สูงกว่าช่วงมาตรฐาน (${std[0]}-${std[1]} RPM)
                                     <span class="engineering-note"><strong>ผลกระทบทางวิศวกรรม:</strong> ทำให้เครื่องยนต์ทำงานหนักเกินความจำเป็น สิ้นเปลืองเชื้อเพลิง และเพิ่มการสึกหรอในระยะยาว อาจสร้างแรงดันในระบบสูงเกินไปจนเป็นอันตรายต่อท่อและข้อต่อได้</span>
                                     <span class="engineering-note"><strong>คำแนะนำ:</strong> ปรับจูน Governor หรือระบบควบคุมรอบเครื่องยนต์</span>`
            },
            'entry.797055912': { label: 'แรงดันน้ำที่เครื่องยนต์เริ่มทำงาน', type: 'numeric_range', std: [94, 104], severity: 'critical',
                low_message: (val, std) => `<strong>วินิจฉัย:</strong> Fire Pump ตั้งค่าแรงดันเริ่มทำงานที่ ${val} PSI ซึ่งต่ำกว่าช่วงมาตรฐาน (${std[0]}-${std[1]} PSI)
                                     <span class="engineering-note"><strong>ผลกระทบทางวิศวกรรม:</strong> นี่คือจุดวิกฤต! การตั้งค่าที่ต่ำไปอาจทำให้ Fire Pump เริ่มทำงานช้าเกินไปในสถานการณ์เพลิงไหม้จริง ทำให้การตอบสนองต่อเหตุการณ์ล่าช้า</span>
                                     <span class="engineering-note"><strong>คำแนะนำ:</strong> ต้องทำการปรับตั้ง Pressure Switch ของ Fire Pump ให้เริ่มทำงานที่ 99 PSI (หรือต่ำกว่าแรงดันเริ่มของ Jockey Pump) โดยทันที</span>`,
                high_message: (val, std) => `<strong>วินิจฉัย:</strong> Fire Pump ตั้งค่าแรงดันเริ่มทำงานที่ ${val} PSI ซึ่งสูงกว่าช่วงมาตรฐาน (${std[0]}-${std[1]} PSI)
                                     <span class="engineering-note"><strong>ผลกระทบทางวิศวกรรม:</strong> นี่คือจุดวิกฤต! หากตั้งค่าสูงเกินไป (ใกล้เคียงกับแรงดันเริ่มของ Jockey Pump) อาจทำให้ Fire Pump ไม่ทำงานเลย เพราะ Jockey Pump จะทำงานก่อนเสมอ</span>
                                     <span class="engineering-note"><strong>คำแนะนำ:</strong> ต้องทำการปรับตั้ง Pressure Switch ของ Fire Pump ให้เริ่มทำงานที่ 99 PSI โดยทันที</span>`
            },
        };

        function generateAiAnalysis(data) {
            const labelMap = getLabelMap();
            let criticalIssues = new Set();
            let warnings = new Set();
            
            for (const entryId in analysisRules) {
                const rule = analysisRules[entryId];
                const rawValue = data[entryId];
                
                if (rawValue === undefined || rawValue === '' || rawValue === null) continue;

                let issue = '';
                const numericValue = parseFloat(rawValue);

                switch (rule.type) {
                    case 'equals':
                        if (rawValue === rule.std) { issue = `<li>${rule.message}</li>`; }
                        break;
                    case 'less_than':
                        if (!isNaN(numericValue) && numericValue < rule.std) {
                            issue = `<li>${rule.message(rawValue, rule.std)}</li>`;
                        }
                        break;
                    case 'numeric_range':
                        if (!isNaN(numericValue) && rule.std.length === 2) {
                            if (numericValue < rule.std[0]) {
                                issue = `<li>${rule.low_message(rawValue, rule.std)}</li>`;
                            } else if (numericValue > rule.std[1]) {
                                issue = `<li>${rule.high_message(rawValue, rule.std)}</li>`;
                            }
                        }
                        break;
                }

                if (issue) {
                    if (rule.severity === 'critical') { criticalIssues.add(issue); } 
                    else { warnings.add(issue); }
                }
            }
            
            const keywordRules = [
                { keyword: 'รั่ว', severity: 'critical', message: (label, text) => `<strong>การวิเคราะห์ข้อความ:</strong> ตรวจพบการระบุถึง "การรั่วซึม" ในหัวข้อ "${label}" <span class="engineering-note"><strong>ข้อความ:</strong> "${text}"<br><strong>ผลกระทบ:</strong> การรั่วซึมทุกชนิดคือความเสี่ยงร้ายแรงที่ต้องตรวจสอบโดยละเอียดทันที</span>` },
                { keyword: 'ซึม', severity: 'critical', message: (label, text) => `<strong>การวิเคราะห์ข้อความ:</strong> ตรวจพบการระบุถึง "การซึม" ในหัวข้อ "${label}" <span class="engineering-note"><strong>ข้อความ:</strong> "${text}"<br><strong>คำแนะนำ:</strong> การซึมเป็นสัญญาณเริ่มต้นของการรั่วไหล ควรหาที่มาและทำการแก้ไขก่อนจะลุกลาม</span>` },
                { keyword: 'แตก', severity: 'warning', message: (label, text) => `<strong>การวิเคราะห์ข้อความ:</strong> ตรวจพบการระบุถึงการ "แตก" ของชิ้นส่วน ในหัวข้อ "${label}" <span class="engineering-note"><strong>ข้อความ:</strong> "${text}"<br><strong>คำแนะนำ:</strong> ชิ้นส่วนที่แตกอาจส่งผลต่อประสิทธิภาพและความปลอดภัย ควรตรวจสอบและพิจารณาเปลี่ยน</span>` },
                { keyword: 'ร้าว', severity: 'warning', message: (label, text) => `<strong>การวิเคราะห์ข้อความ:</strong> พบการระบุถึง "รอยร้าว" ในหัวข้อ "${label}" <span class="engineering-note"><strong>ข้อความ:</strong> "${text}"<br><strong>คำแนะนำ:</strong> รอยร้าวสามารถขยายตัวได้เมื่อรับแรงสั่นสะเทือนหรือความร้อน ควรตรวจสอบและเฝ้าระวังเป็นพิเศษ</span>` }
            ];

            for(const name in data) {
                const value = data[name];
                if(typeof value === 'string' && value.trim() !== '') {
                    const lowerCaseValue = value.toLowerCase();
                    const isOtherField = name.includes('.other_option_response');
                    const isTextField = name === 'entry.129342865' || name === 'entry.690163791' || name === 'entry.788703385';

                    if (isOtherField || isTextField) {
                        const label = labelMap.get(name) || name;
                        keywordRules.forEach(rule => {
                            if (lowerCaseValue.includes(rule.keyword)) {
                                const issue = `<li>${rule.message(label, value)}</li>`;
                                if (rule.severity === 'critical') criticalIssues.add(issue);
                                else warnings.add(issue);
                            }
                        });
                    }
                }
            }
            
            const critArray = Array.from(criticalIssues);
            const warnArray = Array.from(warnings);
            let html = '';

            if (critArray.length > 0) { html += `<div class="ai-response-card ai-critical"><h3>🚨 รายการต้องแก้ไขเร่งด่วน</h3><ul>${critArray.join('')}</ul></div>`; }
            if (warnArray.length > 0) { html += `<div class="ai-response-card ai-warning"><h3>⚠️ ข้อควรระวังทางวิศวกรรม</h3><ul>${warnArray.join('')}</ul></div>`; }
            
            if (critArray.length === 0 && warnArray.length === 0) {
                html = `<div class="ai-response-card ai-summary"><h3>✅ สรุปภาพรวม</h3><p>จากการวิเคราะห์ข้อมูล ไม่พบความผิดปกติที่มีนัยสำคัญทางวิศวกรรม ระบบอยู่ในสถานะพร้อมใช้งาน</p></div>` + html;
            } else {
                html = `<div class="ai-response-card ai-summary"><h3>📝 สรุปภาพรวม</h3><p>ตรวจพบ ${critArray.length} ปัญหาระดับวิกฤต และ ${warnArray.length} ข้อควรระวัง กรุณาดำเนินการตามคำแนะนำทางวิศวกรรมด้านล่าง</p></div>` + html;
            }
            
            html += `<div class="ai-response-card ai-recommendation"><h3>💡 คำแนะนำทั่วไป</h3><p>ควรมีการจัดทำ Logbook เพื่อบันทึกค่าที่วัดได้และกิจกรรมการบำรุงรักษาทุกครั้ง ซึ่งจะช่วยในการวิเคราะห์แนวโน้ม (Trend Analysis) และการบำรุงรักษาเชิงพยากรณ์ (Predictive Maintenance) ในอนาคต</p></div>`;
                    
            return html;
        }

        function initAnimations() {
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('is-visible');
                    }
                });
            }, { threshold: 0.1 });

            document.querySelectorAll('.section-card').forEach(card => {
                observer.observe(card);
            });
        }
    </script>
</body>
</html>
